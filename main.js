(()=>{"use strict";class e{constructor(e){this.name=e,this.arrayOfTodos=[]}}let t=[];function n(n){let r=new e(n);t.push(r),document.querySelector(".content").textContent="";let c=s(r);if(r.arrayOfTodos.push(c),"Inbox"!==n&&localStorage.setItem("projects",JSON.stringify(t)),"Inbox"==n)return r;o()}function o(e){document.querySelector(".projects").textContent="",t.forEach((n=>{let r=document.createElement("div");r.className="project",r.textContent=n.name;let c=document.createElement("button");c.classList.add("project__btn"),c.textContent="x",c.addEventListener("click",(()=>{var e;e=n,t=t.filter((t=>t!==e)),localStorage.setItem("projects",JSON.stringify(t)),console.log(t),o(1),document.querySelector(".content").textContent=""})),r.addEventListener("click",(()=>{e||a(n),e||console.log("no index")})),r.appendChild(c),"Inbox"!==n.name&&document.querySelector(".projects").appendChild(r)}))}function r(){document.querySelector(".content").textContent="",document.querySelector(".create-button").textContent="";let e=document.createElement("div");e.className="today";let n=function(){let e=new Date,t=String(e.getDate()).padStart(2,"0"),n=String(e.getMonth()+1).padStart(2,"0"),o=e.getFullYear();return e=o+"-"+n+"-"+t,e}();d("Today"),t.forEach((e=>{for(let t=1;t<e.arrayOfTodos.length;t++)e.arrayOfTodos[t].date==n&&a(e,t)})),document.querySelector(".today").appendChild(e)}function c(){document.querySelector(".content").textContent="",document.querySelector(".create-button").textContent="";let e=document.createElement("div");e.className="upcoming";let n=new Date,o=String(n.getDate()).padStart(2,"0"),r=String(n.getMonth()+1).padStart(2,"0"),c=n.getFullYear();n=c+"/"+r+"/"+o,d("Upcoming");for(let e in t)for(let n=1;n<t[e].arrayOfTodos.length;n++)t[e].arrayOfTodos[n].date.substr(0,4)>c&&a(t[e],n,"upcoming"),t[e].arrayOfTodos[n].date.substr(0,4)==c&&t[e].arrayOfTodos[n].date.substr(5,2)>r&&a(t[e],n,"upcoming"),t[e].arrayOfTodos[n].date.substr(0,4)==c&&t[e].arrayOfTodos[n].date.substr(5,2)==r&&t[e].arrayOfTodos[n].date.substr(8,2)>o&&a(t[e],n,"upcoming");document.querySelector(".upcoming").appendChild(e)}function a(e,n,o){n||(document.querySelector(".content").textContent="",document.querySelector(".create-button").textContent="",d(e)),console.log(e);for(let d=1;d<e.arrayOfTodos.length;d++){let l=document.createElement("div");l.className="task";let s=document.createElement("div");s.textContent="",s.className="checkbox",l.appendChild(s);let u=document.createElement("div");u.textContent=e.arrayOfTodos[d].name,u.className="taskname",l.appendChild(u);let i=document.createElement("div");i.textContent="Project: "+e.name,i.className="father-project",l.appendChild(i);let m=document.createElement("div");m.textContent=e.arrayOfTodos[d].description,m.className="description",l.appendChild(m),1==e.arrayOfTodos[d].priority&&(s.style.background="red"),2==e.arrayOfTodos[d].priority&&(s.style.background="orange"),3==e.arrayOfTodos[d].priority&&(s.style.background="yellow"),0==e.arrayOfTodos[d].priority&&(s.style.background="white"),s.addEventListener("click",(()=>{var l;l=d,e.arrayOfTodos.splice(l,1),localStorage.setItem("projects",JSON.stringify(t)),n?n&&"upcoming"==o?c():r():a(e)}));let p=document.createElement("div");l.appendChild(p),p.className="date",p.textContent=e.arrayOfTodos[d].date,n?n==d&&document.querySelector(".content").appendChild(l):document.querySelector(".content").appendChild(l)}n||s(e),localStorage.setItem("projects",JSON.stringify(t))}function d(e){e.name?document.querySelector(".project-name").textContent=e.name:document.querySelector(".project-name").textContent=e}function l(e){return t.forEach((t=>{if(t.name==e)return!0})),!1}function s(e){let t=document.createElement("button");document.querySelector(".create-button").appendChild(t),t.textContent="Create todo",t.className="create-button__btn",t.addEventListener("click",(()=>{!function(e){let t=document.querySelector(".popup-container");t.style.transform="scale(1)",document.body.addEventListener("click",(function(e){e.target==t&&(t.style.transform="scale(0)")})),document.querySelector(".submit-button").addEventListener("click",u,!1),document.querySelector(".submit-button").parameter=e}(e)}))}function u(e){let n=document.getElementById("taskname").value,o=document.getElementById("description").value,r=document.getElementById("date").value,c=document.getElementById("priority").value;if(n){let d=function(e,t,n,o){return{name:e,description:t,date:n,priority:o}}(n,o,r,c);e.currentTarget.parameter.arrayOfTodos.push(d),localStorage.setItem("projects",JSON.stringify(t)),document.querySelector(".popup-container").style.transform="scale(0)",a(e.currentTarget.parameter)}else alert("Enter task name")}console.log(t),localStorage,function(){d("Inbox"),l();let e=n("Inbox");document.querySelector(".inbox").addEventListener("click",(()=>{a(e)}))}(),o(),document.querySelector(".today").addEventListener("click",r),document.querySelector(".upcoming").addEventListener("click",c),document.querySelector(".projects__btn").addEventListener("click",(function e(){this.removeEventListener("click",e);var t=document.querySelector(".projects");let o=document.createElement("button");o.classList.add("projects__btn","projects__btn--close"),o.textContent="x",o.addEventListener("click",(()=>{t.removeChild(r),t.removeChild(c),t.removeChild(o),this.addEventListener("click",e)}));var r=document.createElement("input");r.setAttribute("type","text"),r.classList.add("projects__name-input"),t.appendChild(r);var c=document.createElement("button");o.classList.add("projects__btn","projects__btn--submit"),t.appendChild(o),t.appendChild(c),c.textContent="Ok",c.addEventListener("click",(()=>{let o=r.value;o&&o.length<16&&!l(o)?(t.removeChild(r),t.removeChild(c),document.querySelector(".create-button").textContent="",document.querySelector(".project-name").textContent=o,n(o),this.addEventListener("click",e)):1==l(o)?(alert("Project names should be different"),r.value=""):o.length>=16?alert("Project name should be less than 16 characters"):o||alert("Enter project name")}))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WUFBWTJELEdBQ3hCQSxFQUEyQmpGLFlBQWMsS0FHekNpRixFQUEyQmhFLGlCQUFpQixTQUFTLEtBQ2pELElBQUkxQixFQUFPeUYsRUFBb0JaLE1BRTVCN0UsR0FBUUEsRUFBSzhDLE9BQVMsS0FBT21CLEVBQXNCakUsSUFDbERzRixFQUFZRSxZQUFZQyxHQUN4QkgsRUFBWUUsWUFBWUUsR0FDeEJuRixTQUFTQyxjQUFjLGtCQUFrQkMsWUFBYyxHQUN2REYsU0FBU0MsY0FBYyxpQkFBaUJDLFlBQWNULEVBQ3RESSxFQUFjSixHQUNkQyxLQUFLeUIsaUJBQWlCLFFBQVMwRCxJQUNLLEdBQS9CbkIsRUFBc0JqRSxJQUMzQmlGLE1BQU0scUNBQ05RLEVBQW9CWixNQUFRLElBQ3ZCN0UsRUFBSzhDLFFBQVUsR0FDcEJtQyxNQUFNLGtEQUNBakYsR0FDTmlGLE1BQU0sNkIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wYWNrYWdlLy4vc3JjL3Byb2plY3RzLmpzIiwid2VicGFjazovL3BhY2thZ2UvLi9zcmMvdXBkYXRlUHJvamVjdHNET00uanMiLCJ3ZWJwYWNrOi8vcGFja2FnZS8uL3NyYy91cGRhdGVUb2Rvc0RPTS5qcyIsIndlYnBhY2s6Ly9wYWNrYWdlLy4vc3JjL3RvZG9zLmpzIiwid2VicGFjazovL3BhY2thZ2UvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgUHJvamVjdHtcbiAgICBjb25zdHJ1Y3RvcihuYW1lKXtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy5hcnJheU9mVG9kb3MgPSBbXTtcbiAgICB9XG4gICAgXG4gICAgLy9mdW5jdGlvbnMgdG8gYWx0ZXIgdGFza3MgaW5zaWRlIGEgcHJvamVjdFxufVxuXG5leHBvcnQge1Byb2plY3R9OyIsImltcG9ydCB7IFByb2plY3QgfSBmcm9tIFwiLi9wcm9qZWN0c1wiO1xuaW1wb3J0IHsgVG9kb0J1dHRvbiB9IGZyb20gXCIuL3VwZGF0ZVRvZG9zRE9NXCI7XG5cbmxldCBhcnJheU9mUHJvamVjdHMgPSBbXTtcbmNvbnNvbGUubG9nKGFycmF5T2ZQcm9qZWN0cyk7XG5cbihmdW5jdGlvbiBjaGVja1Byb2plY3RzT25SZWxvYWQoKSB7XG4gICAgaWYoJ3Byb2plY3RzJyBpbiBsb2NhbFN0b3JhZ2Upe1xuICAgICAgICAvLyBhcnJheU9mUHJvamVjdHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdwcm9qZWN0cycpIHx8IFtdKTtcbiAgICB9ZWxzZXtcbiAgICB9XG4gICAgY3JlYXRlSW5ib3goKTtcbiAgICB1cGRhdGVQcm9qZWN0cygpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50b2RheScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY3JlYXRlVG9kYXlzVGFza3MpO1xuICAgIFxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy51cGNvbWluZycpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY3JlYXRlVXBjb21pbmdUYXNrcyk7XG59KSgpO1xuXG5mdW5jdGlvbiBjcmVhdGVJbmJveCgpIHtcbiAgICB1cGRhdGVDdXJyZW50UHJvamVjdCgnSW5ib3gnKTsgLy8gVXBkYXRlcyBjdXJyZW50IHdvcmtpbmcgcHJvamVjdCBcblxuICAgIGlmIChjaGVja0lkZW50aWNhbFByb2plY3QoKSkge1xuICAgIH1cbiAgICBsZXQgaW5ib3ggPSBjcmVhdGVQcm9qZWN0KCdJbmJveCcpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pbmJveCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBjcmVhdGVBbGxUYXNrc0luUHJvamVjdChpbmJveCk7XG4gICAgfSk7XG59O1xuXG5mdW5jdGlvbiBjcmVhdGVQcm9qZWN0KG5hbWUpIHtcbiAgICBsZXQgbmV3UHJvamVjdCA9IG5ldyBQcm9qZWN0KG5hbWUpO1xuICAgIGFycmF5T2ZQcm9qZWN0cy5wdXNoKG5ld1Byb2plY3QpO1xuICAgIFxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250ZW50JykudGV4dENvbnRlbnQgPSAnJztcbiAgICBcbiAgICBsZXQgdGFza0luc2lkZVByb2plY3QgPSBUb2RvQnV0dG9uKG5ld1Byb2plY3QpO1xuICAgIG5ld1Byb2plY3QuYXJyYXlPZlRvZG9zLnB1c2godGFza0luc2lkZVByb2plY3QpO1xuICAgIFxuICAgIGlmKG5hbWUgIT09ICdJbmJveCcpIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwcm9qZWN0cycsIEpTT04uc3RyaW5naWZ5KGFycmF5T2ZQcm9qZWN0cykpO1xuXG4gICAgaWYobmFtZSA9PSAnSW5ib3gnKSByZXR1cm4gbmV3UHJvamVjdDtcbiAgICAgICAgXG4gICAgdXBkYXRlUHJvamVjdHMoKTtcbn1cblxuZnVuY3Rpb24gdXBkYXRlUHJvamVjdHMoaW5kZXgpIHtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdHMnKS50ZXh0Q29udGVudCA9ICcnO1xuXG4gICAgYXJyYXlPZlByb2plY3RzLmZvckVhY2gocHJvamVjdEluQXJyYXkgPT4ge1xuICAgICAgICBsZXQgcHJvamVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBwcm9qZWN0LmNsYXNzTmFtZSA9ICdwcm9qZWN0JztcbiAgICAgICAgICAgIFxuICAgICAgICBwcm9qZWN0LnRleHRDb250ZW50ID0gcHJvamVjdEluQXJyYXkubmFtZTtcbiAgICAgICAgXG4gICAgICAgIGxldCBkZWxldGVQcm9qZWN0QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgIGRlbGV0ZVByb2plY3RCdXR0b24uY2xhc3NMaXN0LmFkZCgncHJvamVjdF9fYnRuJyk7XG4gICAgICAgIGRlbGV0ZVByb2plY3RCdXR0b24udGV4dENvbnRlbnQgPSAneCc7XG4gICAgICAgIFxuICAgICAgICBkZWxldGVQcm9qZWN0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgZGVsZXRlUHJvamVjdChwcm9qZWN0SW5BcnJheSk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgcHJvamVjdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIGlmKCFpbmRleCkgY3JlYXRlQWxsVGFza3NJblByb2plY3QocHJvamVjdEluQXJyYXkpO1xuICAgICAgICAgICAgaWYoIWluZGV4KSBjb25zb2xlLmxvZygnbm8gaW5kZXgnKTtcbiAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgcHJvamVjdC5hcHBlbmRDaGlsZChkZWxldGVQcm9qZWN0QnV0dG9uKTtcbiAgICAgICAgaWYocHJvamVjdEluQXJyYXkubmFtZSAhPT0gJ0luYm94Jyl7XG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdHMnKS5hcHBlbmRDaGlsZChwcm9qZWN0KTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBnZXREYXRlKCkge1xuICAgIGxldCB0b2RheSA9IG5ldyBEYXRlKCk7XG4gICAgbGV0IGRkID0gU3RyaW5nKHRvZGF5LmdldERhdGUoKSkucGFkU3RhcnQoMiwgJzAnKTtcbiAgICBsZXQgbW0gPSBTdHJpbmcodG9kYXkuZ2V0TW9udGgoKSArIDEpLnBhZFN0YXJ0KDIsICcwJyk7IC8vSmFudWFyeSBpcyAwIVxuICAgIGxldCB5eXl5ID0gdG9kYXkuZ2V0RnVsbFllYXIoKTtcblxuICAgIHRvZGF5ID0geXl5eSArICctJyArIG1tICsgJy0nICsgZGQ7XG5cbiAgICByZXR1cm4gdG9kYXk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVRvZGF5c1Rhc2tzKCkge1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250ZW50JykudGV4dENvbnRlbnQgPSAnJztcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY3JlYXRlLWJ1dHRvbicpLnRleHRDb250ZW50ID0gJyc7XG4gICAgXG4gICAgbGV0IHRvZGF5Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdG9kYXlDb250YWluZXIuY2xhc3NOYW1lID0gJ3RvZGF5JztcblxuICAgIGxldCB0b2RheSA9IGdldERhdGUoKTtcblxuICAgIHVwZGF0ZUN1cnJlbnRQcm9qZWN0KCdUb2RheScpO1xuXG4gICAgYXJyYXlPZlByb2plY3RzLmZvckVhY2gocHJvamVjdCA9PiB7XG4gICAgICAgIGZvciAobGV0IGYgPSAxOyBmIDwgcHJvamVjdC5hcnJheU9mVG9kb3MubGVuZ3RoOyBmKyspIHtcbiAgICAgICAgICAgIGlmKHByb2plY3QuYXJyYXlPZlRvZG9zW2ZdLmRhdGUgPT0gdG9kYXkpIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVBbGxUYXNrc0luUHJvamVjdChwcm9qZWN0LCBmKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRvZGF5JykuYXBwZW5kQ2hpbGQodG9kYXlDb250YWluZXIpO1xufTtcblxuZnVuY3Rpb24gY3JlYXRlVXBjb21pbmdUYXNrcygpIHtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGVudCcpLnRleHRDb250ZW50ID0gJyc7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNyZWF0ZS1idXR0b24nKS50ZXh0Q29udGVudCA9ICcnO1xuICAgIGxldCB1cGNvbWluZ0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHVwY29taW5nQ29udGFpbmVyLmNsYXNzTmFtZSA9ICd1cGNvbWluZyc7XG5cbiAgICBsZXQgdG9kYXkgPSBuZXcgRGF0ZSgpO1xuXG4gICAgbGV0IGRkID0gU3RyaW5nKHRvZGF5LmdldERhdGUoKSkucGFkU3RhcnQoMiwgJzAnKTtcbiAgICBsZXQgbW0gPSBTdHJpbmcodG9kYXkuZ2V0TW9udGgoKSArIDEpLnBhZFN0YXJ0KDIsICcwJyk7IC8vSmFudWFyeSBpcyAwIVxuICAgIGxldCB5eXl5ID0gdG9kYXkuZ2V0RnVsbFllYXIoKTtcblxuICAgIHRvZGF5ID0geXl5eSArICcvJyArIG1tICsgJy8nICsgZGQ7ICAgXG5cbiAgICB1cGRhdGVDdXJyZW50UHJvamVjdCgnVXBjb21pbmcnKTtcblxuICAgIGZvcihsZXQgaSBpbiBhcnJheU9mUHJvamVjdHMpIHtcbiAgICAgICAgZm9yKGxldCBmID0gMTsgZiA8IGFycmF5T2ZQcm9qZWN0c1tpXS5hcnJheU9mVG9kb3MubGVuZ3RoOyBmKyspIHtcbiAgICAgICAgICAgIGlmKGFycmF5T2ZQcm9qZWN0c1tpXS5hcnJheU9mVG9kb3NbZl0uZGF0ZS5zdWJzdHIoMCwgNCkgPiB5eXl5KSB7XG4gICAgICAgICAgICAgICAgY3JlYXRlQWxsVGFza3NJblByb2plY3QoYXJyYXlPZlByb2plY3RzW2ldLCBmLCAndXBjb21pbmcnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKGFycmF5T2ZQcm9qZWN0c1tpXS5hcnJheU9mVG9kb3NbZl0uZGF0ZS5zdWJzdHIoMCwgNCkgPT0geXl5eSAmJlxuICAgICAgICAgICAgICAgYXJyYXlPZlByb2plY3RzW2ldLmFycmF5T2ZUb2Rvc1tmXS5kYXRlLnN1YnN0cig1LCAyKSA+IG1tKSB7XG4gICAgICAgICAgICAgICAgY3JlYXRlQWxsVGFza3NJblByb2plY3QoYXJyYXlPZlByb2plY3RzW2ldLCBmLCAndXBjb21pbmcnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKGFycmF5T2ZQcm9qZWN0c1tpXS5hcnJheU9mVG9kb3NbZl0uZGF0ZS5zdWJzdHIoMCwgNCkgPT0geXl5eSAmJlxuICAgICAgICAgICAgICAgYXJyYXlPZlByb2plY3RzW2ldLmFycmF5T2ZUb2Rvc1tmXS5kYXRlLnN1YnN0cig1LCAyKSA9PSBtbSAmJlxuICAgICAgICAgICAgICAgYXJyYXlPZlByb2plY3RzW2ldLmFycmF5T2ZUb2Rvc1tmXS5kYXRlLnN1YnN0cig4LCAyKSA+IGRkKSB7XG4gICAgICAgICAgICAgICAgY3JlYXRlQWxsVGFza3NJblByb2plY3QoYXJyYXlPZlByb2plY3RzW2ldLCBmLCAndXBjb21pbmcnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy51cGNvbWluZycpLmFwcGVuZENoaWxkKHVwY29taW5nQ29udGFpbmVyKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQWxsVGFza3NJblByb2plY3QocHJvamVjdCwgaW5kZXhPZlRvZGF5VGFzaywgb3JpZ2luKSB7XG4gICAgaWYgKCFpbmRleE9mVG9kYXlUYXNrKXtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRlbnQnKS50ZXh0Q29udGVudCA9ICcnO1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY3JlYXRlLWJ1dHRvbicpLnRleHRDb250ZW50ID0gJyc7XG4gICAgICAgIHVwZGF0ZUN1cnJlbnRQcm9qZWN0KHByb2plY3QpO1xuICAgIH1cblxuICAgIGxldCBudW1iZXJPZlRhc2sgPSAwO1xuICAgIGNvbnNvbGUubG9nKHByb2plY3QpO1xuICAgIC8vIHByb2plY3QuYXJyYXlPZlRvZG9zLmZvckVhY2godG9kbyA9PiB7XG4gICAgLy8gICAgIGNvbnNvbGUubG9nKHRvZG8pO1xuICAgIC8vIH0pO1xuICAgIGZvcihsZXQgZiA9IDE7IGYgPCBwcm9qZWN0LmFycmF5T2ZUb2Rvcy5sZW5ndGg7IGYrKykge1xuICAgICAgICBsZXQgdGFza09uVGhlU2NyZWVuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRhc2tPblRoZVNjcmVlbi5jbGFzc05hbWUgPSAndGFzayc7XG4gICAgICAgIFxuICAgICAgICBsZXQgY2hlY2tCb3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgY2hlY2tCb3gudGV4dENvbnRlbnQgPSAnJztcbiAgICAgICAgY2hlY2tCb3guY2xhc3NOYW1lID0gJ2NoZWNrYm94JztcbiAgICAgICAgdGFza09uVGhlU2NyZWVuLmFwcGVuZENoaWxkKGNoZWNrQm94KTtcblxuICAgICAgICBsZXQgdGFza05hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdGFza05hbWUudGV4dENvbnRlbnQgPSBwcm9qZWN0LmFycmF5T2ZUb2Rvc1tmXS5uYW1lO1xuICAgICAgICB0YXNrTmFtZS5jbGFzc05hbWUgPSAndGFza25hbWUnO1xuICAgICAgICB0YXNrT25UaGVTY3JlZW4uYXBwZW5kQ2hpbGQodGFza05hbWUpO1xuXG4gICAgICAgIGxldCBwcm9qZWN0RmF0aGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHByb2plY3RGYXRoZXIudGV4dENvbnRlbnQgPSAnUHJvamVjdDogJyArIHByb2plY3QubmFtZTtcbiAgICAgICAgcHJvamVjdEZhdGhlci5jbGFzc05hbWUgPSAnZmF0aGVyLXByb2plY3QnO1xuICAgICAgICB0YXNrT25UaGVTY3JlZW4uYXBwZW5kQ2hpbGQocHJvamVjdEZhdGhlcik7XG5cbiAgICAgICAgbGV0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGRlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gcHJvamVjdC5hcnJheU9mVG9kb3NbZl0uZGVzY3JpcHRpb247XG4gICAgICAgIGRlc2NyaXB0aW9uLmNsYXNzTmFtZSA9ICdkZXNjcmlwdGlvbic7XG4gICAgICAgIHRhc2tPblRoZVNjcmVlbi5hcHBlbmRDaGlsZChkZXNjcmlwdGlvbik7XG5cbiAgICAgICAgaWYocHJvamVjdC5hcnJheU9mVG9kb3NbZl0ucHJpb3JpdHkgPT0gMSkgY2hlY2tCb3guc3R5bGUuYmFja2dyb3VuZCA9ICdyZWQnO1xuICAgICAgICBpZihwcm9qZWN0LmFycmF5T2ZUb2Rvc1tmXS5wcmlvcml0eSA9PSAyKSBjaGVja0JveC5zdHlsZS5iYWNrZ3JvdW5kID0gJ29yYW5nZSc7XG4gICAgICAgIGlmKHByb2plY3QuYXJyYXlPZlRvZG9zW2ZdLnByaW9yaXR5ID09IDMpIGNoZWNrQm94LnN0eWxlLmJhY2tncm91bmQgPSAneWVsbG93JztcbiAgICAgICAgaWYocHJvamVjdC5hcnJheU9mVG9kb3NbZl0ucHJpb3JpdHkgPT0gMCkgY2hlY2tCb3guc3R5bGUuYmFja2dyb3VuZCA9ICd3aGl0ZSc7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgY2hlY2tCb3guYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBkZWxldGVUYXNrKHByb2plY3QsIGYpO1xuICAgICAgICAgICAgaWYoIWluZGV4T2ZUb2RheVRhc2spIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVBbGxUYXNrc0luUHJvamVjdChwcm9qZWN0KTtcbiAgICAgICAgICAgIH1lbHNlIGlmKGluZGV4T2ZUb2RheVRhc2sgJiYgb3JpZ2luID09ICd1cGNvbWluZycpIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVVcGNvbWluZ1Rhc2tzKCk7XG4gICAgICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICAgICAgY3JlYXRlVG9kYXlzVGFza3MoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgbGV0IGRhdGVQaWNrZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdGFza09uVGhlU2NyZWVuLmFwcGVuZENoaWxkKGRhdGVQaWNrZXIpO1xuICAgICAgICBkYXRlUGlja2VyLmNsYXNzTmFtZSA9ICdkYXRlJztcbiAgICAgICAgZGF0ZVBpY2tlci50ZXh0Q29udGVudCA9IHByb2plY3QuYXJyYXlPZlRvZG9zW2ZdLmRhdGU7XG5cbiAgICAgICAgaWYoaW5kZXhPZlRvZGF5VGFzaykge1xuICAgICAgICAgICAgaWYoaW5kZXhPZlRvZGF5VGFzayA9PSBmKSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGVudCcpLmFwcGVuZENoaWxkKHRhc2tPblRoZVNjcmVlbik7XG4gICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250ZW50JykuYXBwZW5kQ2hpbGQodGFza09uVGhlU2NyZWVuKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZighaW5kZXhPZlRvZGF5VGFzaykgVG9kb0J1dHRvbihwcm9qZWN0KTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJvamVjdHMnLCBKU09OLnN0cmluZ2lmeShhcnJheU9mUHJvamVjdHMpKTtcbn1cblxuZnVuY3Rpb24gdXBkYXRlQ3VycmVudFByb2plY3QocHJvamVjdCkge1xuICAgIChwcm9qZWN0Lm5hbWUpID8gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3QtbmFtZScpLnRleHRDb250ZW50ID0gcHJvamVjdC5uYW1lIDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3QtbmFtZScpLnRleHRDb250ZW50ID0gcHJvamVjdDtcbn1cblxuZnVuY3Rpb24gaW5wdXRQcm9qZWN0TmFtZSgpIHtcbiAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaW5wdXRQcm9qZWN0TmFtZSk7XG4gICAgXG4gICAgdmFyIHByb2plY3RzRGl2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3RzJyk7XG4gICAgbGV0IGNsb3NlQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgY2xvc2VCdXR0b24uY2xhc3NMaXN0LmFkZCgncHJvamVjdHNfX2J0bicsICdwcm9qZWN0c19fYnRuLS1jbG9zZScpO1xuICAgIGNsb3NlQnV0dG9uLnRleHRDb250ZW50ID0gJ3gnO1xuICAgIGNsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBwcm9qZWN0c0Rpdi5yZW1vdmVDaGlsZChpbnB1dEZvclByb2plY3ROYW1lKTtcbiAgICAgICAgcHJvamVjdHNEaXYucmVtb3ZlQ2hpbGQoc3VibWl0QnV0dG9uRm9yUHJvamVjdE5hbWUpO1xuICAgICAgICBwcm9qZWN0c0Rpdi5yZW1vdmVDaGlsZChjbG9zZUJ1dHRvbik7XG4gICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBpbnB1dFByb2plY3ROYW1lKTtcbiAgICB9KTtcbiAgICBcbiAgICB2YXIgaW5wdXRGb3JQcm9qZWN0TmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgaW5wdXRGb3JQcm9qZWN0TmFtZS5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAndGV4dCcpO1xuICAgIGlucHV0Rm9yUHJvamVjdE5hbWUuY2xhc3NMaXN0LmFkZCgncHJvamVjdHNfX25hbWUtaW5wdXQnKTtcbiAgICBcbiAgICBwcm9qZWN0c0Rpdi5hcHBlbmRDaGlsZChpbnB1dEZvclByb2plY3ROYW1lKTtcbiAgICBcbiAgICB2YXIgc3VibWl0QnV0dG9uRm9yUHJvamVjdE5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICBjbG9zZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdwcm9qZWN0c19fYnRuJywgJ3Byb2plY3RzX19idG4tLXN1Ym1pdCcpO1xuXG4gICAgcHJvamVjdHNEaXYuYXBwZW5kQ2hpbGQoY2xvc2VCdXR0b24pO1xuICAgIHByb2plY3RzRGl2LmFwcGVuZENoaWxkKHN1Ym1pdEJ1dHRvbkZvclByb2plY3ROYW1lKTtcbiAgICBzdWJtaXRCdXR0b25Gb3JQcm9qZWN0TmFtZS50ZXh0Q29udGVudCA9ICdPayc7XG5cbiAgICBcbiAgICBzdWJtaXRCdXR0b25Gb3JQcm9qZWN0TmFtZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgbGV0IG5hbWUgPSBpbnB1dEZvclByb2plY3ROYW1lLnZhbHVlO1xuICAgICAgICBcbiAgICAgICAgaWYobmFtZSAmJiBuYW1lLmxlbmd0aCA8IDE2ICYmICFjaGVja0lkZW50aWNhbFByb2plY3QobmFtZSkpIHtcbiAgICAgICAgICAgIHByb2plY3RzRGl2LnJlbW92ZUNoaWxkKGlucHV0Rm9yUHJvamVjdE5hbWUpO1xuICAgICAgICAgICAgcHJvamVjdHNEaXYucmVtb3ZlQ2hpbGQoc3VibWl0QnV0dG9uRm9yUHJvamVjdE5hbWUpO1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNyZWF0ZS1idXR0b24nKS50ZXh0Q29udGVudCA9ICcnO1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3QtbmFtZScpLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICAgICAgICAgIGNyZWF0ZVByb2plY3QobmFtZSk7XG4gICAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaW5wdXRQcm9qZWN0TmFtZSk7XG4gICAgICAgIH1lbHNlIGlmKGNoZWNrSWRlbnRpY2FsUHJvamVjdChuYW1lKSA9PSB0cnVlKSB7XG4gICAgICAgICAgICBhbGVydCgnUHJvamVjdCBuYW1lcyBzaG91bGQgYmUgZGlmZmVyZW50Jyk7XG4gICAgICAgICAgICBpbnB1dEZvclByb2plY3ROYW1lLnZhbHVlID0gJyc7XG4gICAgICAgIH1lbHNlIGlmKG5hbWUubGVuZ3RoID49IDE2KXtcbiAgICAgICAgICAgIGFsZXJ0KCdQcm9qZWN0IG5hbWUgc2hvdWxkIGJlIGxlc3MgdGhhbiAxNiBjaGFyYWN0ZXJzJyk7XG4gICAgICAgIH1lbHNlIGlmKCFuYW1lKXtcbiAgICAgICAgICAgIGFsZXJ0KCdFbnRlciBwcm9qZWN0IG5hbWUnKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBjaGVja0lkZW50aWNhbFByb2plY3QobmFtZSkge1xuICAgIGFycmF5T2ZQcm9qZWN0cy5mb3JFYWNoKHByb2plY3QgPT4ge1xuICAgICAgICBpZihwcm9qZWN0Lm5hbWUgPT0gbmFtZSkgcmV0dXJuIHRydWU7XG4gICAgfSApO1xuICAgIHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24gZGVsZXRlVGFzayhuZXdQcm9qZWN0LCBudW1iZXJPZlRhc2spIHtcbiAgICBuZXdQcm9qZWN0LmFycmF5T2ZUb2Rvcy5zcGxpY2UobnVtYmVyT2ZUYXNrLCAxKTsgXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Byb2plY3RzJywgSlNPTi5zdHJpbmdpZnkoYXJyYXlPZlByb2plY3RzKSk7XG59XG5cbmZ1bmN0aW9uIGRlbGV0ZVByb2plY3QobmV3UHJvamVjdCkge1xuICAgIGFycmF5T2ZQcm9qZWN0cyA9IGFycmF5T2ZQcm9qZWN0cy5maWx0ZXIocHJvamVjdCA9PiBwcm9qZWN0ICE9PSBuZXdQcm9qZWN0KTtcblxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwcm9qZWN0cycsIEpTT04uc3RyaW5naWZ5KGFycmF5T2ZQcm9qZWN0cykpO1xuXG4gICAgLy8gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNyZWF0ZS1idXR0b24nKS50ZXh0Q29udGVudCA9ICcnO1xuICAgIC8vIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9qZWN0LW5hbWUnKS50ZXh0Q29udGVudCA9ICcnO1xuICAgIGNvbnNvbGUubG9nKGFycmF5T2ZQcm9qZWN0cyk7XG4gICAgdXBkYXRlUHJvamVjdHMoMSk7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRlbnQnKS50ZXh0Q29udGVudCA9ICcnO1xufVxuXG5leHBvcnQge2lucHV0UHJvamVjdE5hbWUsIGNyZWF0ZUFsbFRhc2tzSW5Qcm9qZWN0LCBhcnJheU9mUHJvamVjdHN9IiwiaW1wb3J0IHsgVG9kbyB9IGZyb20gXCIuL3RvZG9zXCI7XG5pbXBvcnQgeyBjcmVhdGVBbGxUYXNrc0luUHJvamVjdCwgYXJyYXlPZlByb2plY3RzIH0gZnJvbSBcIi4vdXBkYXRlUHJvamVjdHNET01cIjtcblxuZnVuY3Rpb24gVG9kb0J1dHRvbihuZXdQcm9qZWN0KSB7XG4gICAgbGV0IHRvZG9CdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgIFxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jcmVhdGUtYnV0dG9uJykuYXBwZW5kQ2hpbGQodG9kb0J1dHRvbik7XG4gICAgdG9kb0J1dHRvbi50ZXh0Q29udGVudCA9ICdDcmVhdGUgdG9kbyc7XG4gICAgdG9kb0J1dHRvbi5jbGFzc05hbWUgPSAnY3JlYXRlLWJ1dHRvbl9fYnRuJztcblxuICAgIHRvZG9CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGNyZWF0ZVBvcHVwKG5ld1Byb2plY3QpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVQb3B1cChuZXdQcm9qZWN0KSB7XG4gICAgLy8gcG9wdXAuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgbGV0IHBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwLWNvbnRhaW5lcicpO1xuICAgIHBvcHVwLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZSgxKSc7XG4gICAgXG4gICAgZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIGlmIChldmVudC50YXJnZXQgPT0gcG9wdXApIHtcbiAgICAgICAgICAgIHBvcHVwLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZSgwKSc7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnN1Ym1pdC1idXR0b25cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGdldERhdGFGcm9tRm9ybSwgZmFsc2UpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc3VibWl0LWJ1dHRvblwiKS5wYXJhbWV0ZXIgPSBuZXdQcm9qZWN0O1xufVxuXG5mdW5jdGlvbiBnZXREYXRhRnJvbUZvcm0oZSkge1xuICAgIGxldCBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2tuYW1lJykudmFsdWU7XG4gICAgbGV0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rlc2NyaXB0aW9uJykudmFsdWU7XG4gICAgbGV0IGRhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGF0ZScpLnZhbHVlO1xuICAgIGxldCBwcmlvcml0eSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmlvcml0eScpLnZhbHVlO1xuXG4gICAgaWYgKG5hbWUpIHtcbiAgICAgICAgbGV0IHRhc2sgPSBUb2RvKG5hbWUsIGRlc2NyaXB0aW9uLCBkYXRlLCBwcmlvcml0eSlcbiAgICAgICAgZS5jdXJyZW50VGFyZ2V0LnBhcmFtZXRlci5hcnJheU9mVG9kb3MucHVzaCh0YXNrKTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Byb2plY3RzJywgSlNPTi5zdHJpbmdpZnkoYXJyYXlPZlByb2plY3RzKSk7XG5cbiAgICAgICAgbGV0IHBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwLWNvbnRhaW5lcicpO1xuICAgICAgICBwb3B1cC5zdHlsZS50cmFuc2Zvcm0gPSAnc2NhbGUoMCknO1xuXG4gICAgICAgIGNyZWF0ZUFsbFRhc2tzSW5Qcm9qZWN0KGUuY3VycmVudFRhcmdldC5wYXJhbWV0ZXIpO1xuICAgIH1lbHNlIHtcbiAgICAgICAgYWxlcnQoJ0VudGVyIHRhc2sgbmFtZScpO1xuICAgIH1cblxufVxuXG5leHBvcnQgeyBUb2RvQnV0dG9uIH0iLCJmdW5jdGlvbiBUb2RvKG5hbWUsIGRlc2NyaXB0aW9uLCBkYXRlLCBwcmlvcml0eSl7XG4gICAgcmV0dXJue1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24sXG4gICAgICAgIGRhdGU6IGRhdGUsXG4gICAgICAgIHByaW9yaXR5OiBwcmlvcml0eSxcbiAgICB9XG59XG5cbmV4cG9ydCB7VG9kb307IiwiaW1wb3J0IHsgY3JlYXRlVG9kbyB9IGZyb20gXCIuL3VwZGF0ZVRvZG9zRE9NXCI7XG5pbXBvcnQgeyBpbnB1dFByb2plY3ROYW1lIH0gZnJvbSBcIi4vdXBkYXRlUHJvamVjdHNET01cIjtcblxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3RzX19idG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGlucHV0UHJvamVjdE5hbWUpOyJdLCJuYW1lcyI6WyJQcm9qZWN0IiwiY29uc3RydWN0b3IiLCJuYW1lIiwidGhpcyIsImFycmF5T2ZUb2RvcyIsImFycmF5T2ZQcm9qZWN0cyIsImNyZWF0ZVByb2plY3QiLCJuZXdQcm9qZWN0IiwicHVzaCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInRleHRDb250ZW50IiwidGFza0luc2lkZVByb2plY3QiLCJUb2RvQnV0dG9uIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1cGRhdGVQcm9qZWN0cyIsImluZGV4IiwiZm9yRWFjaCIsInByb2plY3RJbkFycmF5IiwicHJvamVjdCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJkZWxldGVQcm9qZWN0QnV0dG9uIiwiY2xhc3NMaXN0IiwiYWRkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImZpbHRlciIsImNvbnNvbGUiLCJsb2ciLCJjcmVhdGVBbGxUYXNrc0luUHJvamVjdCIsImFwcGVuZENoaWxkIiwiY3JlYXRlVG9kYXlzVGFza3MiLCJ0b2RheUNvbnRhaW5lciIsInRvZGF5IiwiRGF0ZSIsImRkIiwiU3RyaW5nIiwiZ2V0RGF0ZSIsInBhZFN0YXJ0IiwibW0iLCJnZXRNb250aCIsInl5eXkiLCJnZXRGdWxsWWVhciIsInVwZGF0ZUN1cnJlbnRQcm9qZWN0IiwiZiIsImxlbmd0aCIsImRhdGUiLCJjcmVhdGVVcGNvbWluZ1Rhc2tzIiwidXBjb21pbmdDb250YWluZXIiLCJpIiwic3Vic3RyIiwiaW5kZXhPZlRvZGF5VGFzayIsIm9yaWdpbiIsInRhc2tPblRoZVNjcmVlbiIsImNoZWNrQm94IiwidGFza05hbWUiLCJwcm9qZWN0RmF0aGVyIiwiZGVzY3JpcHRpb24iLCJwcmlvcml0eSIsInN0eWxlIiwiYmFja2dyb3VuZCIsIm51bWJlck9mVGFzayIsInNwbGljZSIsImRhdGVQaWNrZXIiLCJjaGVja0lkZW50aWNhbFByb2plY3QiLCJ0b2RvQnV0dG9uIiwicG9wdXAiLCJ0cmFuc2Zvcm0iLCJib2R5IiwiZXZlbnQiLCJ0YXJnZXQiLCJnZXREYXRhRnJvbUZvcm0iLCJwYXJhbWV0ZXIiLCJjcmVhdGVQb3B1cCIsImUiLCJnZXRFbGVtZW50QnlJZCIsInZhbHVlIiwidGFzayIsIlRvZG8iLCJjdXJyZW50VGFyZ2V0IiwiYWxlcnQiLCJpbmJveCIsImNyZWF0ZUluYm94IiwiaW5wdXRQcm9qZWN0TmFtZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJwcm9qZWN0c0RpdiIsImNsb3NlQnV0dG9uIiwicmVtb3ZlQ2hpbGQiLCJpbnB1dEZvclByb2plY3ROYW1lIiwic3VibWl0QnV0dG9uRm9yUHJvamVjdE5hbWUiLCJzZXRBdHRyaWJ1dGUiXSwic291cmNlUm9vdCI6IiJ9