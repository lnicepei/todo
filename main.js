(()=>{"use strict";class e{constructor(e){this.name=e,this.arrayOfTodos=[]}}let t=[];function n(n){let r=new e(n);t.push(r),document.querySelector(".content").textContent="";let c=u(r);if(r.arrayOfTodos.push(c),localStorage.setItem("projects",JSON.stringify(t)),"Inbox"==n)return r;o()}function o(){document.querySelector(".projects").textContent="";for(let e=1;e<t.length;e++)if("Inbox"!==t[e].name){let n=document.createElement("div");n.className="project",document.querySelector(".projects").appendChild(n),n.textContent=t[e].name;let o=document.createElement("button");o.classList.add("project__btn"),o.textContent="x",o.addEventListener("click",(()=>{s(t[e])})),n.addEventListener("click",(()=>{a(t[e])})),n.appendChild(o)}}function r(){document.querySelector(".content").textContent="",document.querySelector(".create-button").textContent="";let e=document.createElement("div");e.className="today";let n=function(){let e=new Date,t=String(e.getDate()).padStart(2,"0"),n=String(e.getMonth()+1).padStart(2,"0"),o=e.getFullYear();return e=o+"-"+n+"-"+t,e}();l("Today");for(let e in t)for(let o=1;o<t[e].arrayOfTodos.length;o++)t[e].arrayOfTodos[o].date==n&&a(t[e],o);document.querySelector(".today").appendChild(e)}function c(){document.querySelector(".content").textContent="",document.querySelector(".create-button").textContent="";let e=document.createElement("div");e.className="upcoming";let n=new Date,o=String(n.getDate()).padStart(2,"0"),r=String(n.getMonth()+1).padStart(2,"0"),c=n.getFullYear();n=c+"/"+r+"/"+o,l("Upcoming");for(let e in t)for(let n=1;n<t[e].arrayOfTodos.length;n++)t[e].arrayOfTodos[n].date.substr(0,4)>c&&a(t[e],n,"upcoming"),t[e].arrayOfTodos[n].date.substr(0,4)==c&&t[e].arrayOfTodos[n].date.substr(5,2)>r&&a(t[e],n,"upcoming"),t[e].arrayOfTodos[n].date.substr(0,4)==c&&t[e].arrayOfTodos[n].date.substr(5,2)==r&&t[e].arrayOfTodos[n].date.substr(8,2)>o&&a(t[e],n,"upcoming");document.querySelector(".upcoming").appendChild(e)}function a(e,n,o){n||(document.querySelector(".content").textContent="",document.querySelector(".create-button").textContent="",l(e));for(let l=1;l<=e.arrayOfTodos.length-1;l++){let d=document.createElement("div");d.className="task";let s=document.createElement("div");s.textContent="",s.className="checkbox",d.appendChild(s);let u=document.createElement("div");u.textContent=e.arrayOfTodos[l].name,u.className="taskname",d.appendChild(u);let i=document.createElement("div");i.textContent="Project: "+e.name,i.className="father-project",d.appendChild(i);let m=document.createElement("div");m.textContent=e.arrayOfTodos[l].description,m.className="description",d.appendChild(m),1==e.arrayOfTodos[l].priority&&(s.style.background="red"),2==e.arrayOfTodos[l].priority&&(s.style.background="orange"),3==e.arrayOfTodos[l].priority&&(s.style.background="yellow"),0==e.arrayOfTodos[l].priority&&(s.style.background="white"),s.addEventListener("click",(()=>{var d;d=l,e.arrayOfTodos.splice(d,1),localStorage.setItem("projects",JSON.stringify(t)),n?n&&"upcoming"==o?c():r():a(e)}));let p=document.createElement("div");d.appendChild(p),p.className="date",p.textContent=e.arrayOfTodos[l].date,n?n==l&&document.querySelector(".content").appendChild(d):document.querySelector(".content").appendChild(d)}n||u(e),localStorage.setItem("projects",JSON.stringify(t))}function l(e){e.name?document.querySelector(".project-name").textContent=e.name:document.querySelector(".project-name").textContent=e}function d(e){for(let n=0;n<t.length;n++)if(t[n].name==e)return!1;return!0}function s(e){for(let n=0;n<t.length;n++)t[n]==e&&t.splice(n,1);localStorage.setItem("projects",JSON.stringify(t)),document.querySelector(".content").textContent="",document.querySelector(".create-button").textContent="",document.querySelector(".project-name").textContent="",o()}function u(e){let t=document.createElement("button");document.querySelector(".create-button").appendChild(t),t.textContent="Create todo",t.className="create-button__btn",t.addEventListener("click",(()=>{!function(e){let t=document.querySelector(".popup-container");t.style.transform="scale(1)",document.body.addEventListener("click",(function(e){e.target==t&&(t.style.transform="scale(0)")})),document.querySelector(".submit-button").addEventListener("click",i,!1),document.querySelector(".submit-button").parameter=e}(e)}))}function i(e){let n=document.getElementById("taskname").value,o=document.getElementById("description").value,r=document.getElementById("date").value,c=document.getElementById("priority").value;if(n){let l=function(e,t,n,o){return{name:e,description:t,date:n,priority:o}}(n,o,r,c);e.currentTarget.parameter.arrayOfTodos.push(l),localStorage.setItem("projects",JSON.stringify(t)),document.querySelector(".popup-container").style.transform="scale(0)",a(e.currentTarget.parameter)}else alert("Enter task name")}"projects"in localStorage&&(console.log(t),t=JSON.parse(localStorage.getItem("projects")||[]),console.log(t),o()),function(){if(d()){let e=n("Inbox");document.querySelector(".inbox").addEventListener("click",(()=>{a(e),l("Inbox")}))}}(),document.querySelector(".today").addEventListener("click",r),document.querySelector(".upcoming").addEventListener("click",c),document.querySelector(".projects__btn").addEventListener("click",(function e(){this.removeEventListener("click",e);var t=document.querySelector(".projects");let o=document.createElement("button");o.classList.add("projects__btn","projects__btn--close"),o.textContent="x",o.addEventListener("click",(()=>{t.removeChild(r),t.removeChild(c),t.removeChild(o),this.addEventListener("click",e)}));var r=document.createElement("input");r.setAttribute("type","text"),r.classList.add("projects__name-input"),t.appendChild(r);var c=document.createElement("button");o.classList.add("projects__btn","projects__btn--submit"),t.appendChild(o),t.appendChild(c),c.textContent="Ok",c.addEventListener("click",(()=>{let o=r.value;o&&o.length<16&&d(o)?(t.removeChild(r),t.removeChild(c),document.querySelector(".create-button").textContent="",document.querySelector(".project-name").textContent=o,n(o),this.addEventListener("click",e)):0==d(o)?(alert("Project names should be different"),r.value=""):o.length>=16?alert("Project name should be less than 16 characters"):o||alert("Enter project name")}))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUt5QixpQkFBaUIsUUFBU3lELE1BR25DLElBQUlLLEVBQXNCakYsU0FBU2EsY0FBYyxTQUNqRG9FLEVBQW9CRSxhQUFhLE9BQVEsUUFDekNGLEVBQW9CaEUsVUFBVUMsSUFBSSx3QkFFbEM0RCxFQUFZL0QsWUFBWWtFLEdBRXhCLElBQUlDLEVBQTZCbEYsU0FBU2EsY0FBYyxVQUN4RGtFLEVBQVk5RCxVQUFVQyxJQUFJLGdCQUFpQix5QkFFM0M0RCxFQUFZL0QsWUFBWWdFLEdBQ3hCRCxFQUFZL0QsWUFBWW1FLEdBQ3hCQSxFQUEyQmhGLFlBQWMsS0FHekNnRixFQUEyQi9ELGlCQUFpQixTQUFTLEtBQ2pELElBQUkxQixFQUFPd0YsRUFBb0JoQixNQUU1QnhFLEdBQVFBLEVBQUtrQixPQUFTLElBQU0wQyxFQUFzQjVELElBQ2pEcUYsRUFBWUUsWUFBWUMsR0FDeEJILEVBQVlFLFlBQVlFLEdBQ3hCbEYsU0FBU0MsY0FBYyxrQkFBa0JDLFlBQWMsR0FDdkRGLFNBQVNDLGNBQWMsaUJBQWlCQyxZQUFjVCxFQUN0REksRUFBY0osR0FDZEMsS0FBS3lCLGlCQUFpQixRQUFTeUQsSUFDSyxHQUEvQnZCLEVBQXNCNUQsSUFDM0I0RSxNQUFNLHFDQUNOWSxFQUFvQmhCLE1BQVEsSUFDdkJ4RSxFQUFLa0IsUUFBVSxHQUNwQjBELE1BQU0sa0RBQ0E1RSxHQUNONEUsTUFBTSw2QiIsInNvdXJjZXMiOlsid2VicGFjazovL3BhY2thZ2UvLi9zcmMvcHJvamVjdHMuanMiLCJ3ZWJwYWNrOi8vcGFja2FnZS8uL3NyYy91cGRhdGVQcm9qZWN0c0RPTS5qcyIsIndlYnBhY2s6Ly9wYWNrYWdlLy4vc3JjL3VwZGF0ZVRvZG9zRE9NLmpzIiwid2VicGFjazovL3BhY2thZ2UvLi9zcmMvdG9kb3MuanMiLCJ3ZWJwYWNrOi8vcGFja2FnZS8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBQcm9qZWN0e1xuICAgIGNvbnN0cnVjdG9yKG5hbWUpe1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLmFycmF5T2ZUb2RvcyA9IFtdO1xuICAgIH1cbiAgICBcbiAgICAvL2Z1bmN0aW9ucyB0byBhbHRlciB0YXNrcyBpbnNpZGUgYSBwcm9qZWN0XG59XG5cbmV4cG9ydCB7UHJvamVjdH07IiwiaW1wb3J0IHsgUHJvamVjdCB9IGZyb20gXCIuL3Byb2plY3RzXCI7XG5pbXBvcnQgeyBUb2RvQnV0dG9uIH0gZnJvbSBcIi4vdXBkYXRlVG9kb3NET01cIjtcblxubGV0IGFycmF5T2ZQcm9qZWN0cyA9IFtdO1xuXG4oZnVuY3Rpb24gY2hlY2tQcm9qZWN0c09uUmVsb2FkKCkge1xuICAgIGlmKCdwcm9qZWN0cycgaW4gbG9jYWxTdG9yYWdlKXtcbiAgICAgICAgY29uc29sZS5sb2coYXJyYXlPZlByb2plY3RzKTtcbiAgICAgICAgYXJyYXlPZlByb2plY3RzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncHJvamVjdHMnKSB8fCBbXSk7XG4gICAgICAgIGNvbnNvbGUubG9nKGFycmF5T2ZQcm9qZWN0cyk7XG4gICAgICAgIHVwZGF0ZVByb2plY3RzKCk7XG4gICAgfVxuICAgIGNyZWF0ZUluYm94KCk7XG4gICAgXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRvZGF5JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjcmVhdGVUb2RheXNUYXNrcyk7XG4gICAgXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnVwY29taW5nJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjcmVhdGVVcGNvbWluZ1Rhc2tzKTtcbn0pKCk7XG5cbmZ1bmN0aW9uIGNyZWF0ZUluYm94KCkge1xuICAgIC8vIGxldCBpbmJveCA9IG5ldyBQcm9qZWN0KCdJbmJveCcpO1xuICAgIFxuICAgIC8vIC8vIGlmICghY2hlY2tJZGVudGljYWxQcm9qZWN0KGluYm94KSkge1xuICAgICAgICBcbiAgICAgICAgLy8gICAgIGlmKGNoZWNrSWRlbnRpY2FsUHJvamVjdChpbmJveCkgJiYgJ3Byb2plY3RzJyBpbiBsb2NhbFN0b3JhZ2UpIGFycmF5T2ZQcm9qZWN0cy5wdXNoKGluYm94KTtcbiAgICAgICAgXG4gICAgICAgIC8vICAgICBsZXQgdGFza0luc2lkZUluYm94ID0gVG9kb0J1dHRvbihpbmJveCk7XG4gICAgICAgIC8vICAgICBpbmJveC5hcnJheU9mVG9kb3MucHVzaCh0YXNrSW5zaWRlSW5ib3gpO1xuICAgICAgICAgICAgXG4gICAgICAgIC8vICAgICBjcmVhdGVBbGxUYXNrc0luUHJvamVjdChpbmJveCk7XG4gICAgICAgIC8vIC8vIH1cbiAgICAgICAgaWYgKGNoZWNrSWRlbnRpY2FsUHJvamVjdCgpKSB7XG4gICAgICAgICAgICBsZXQgaW5ib3ggPSBjcmVhdGVQcm9qZWN0KCdJbmJveCcpO1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmluYm94JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY3JlYXRlQWxsVGFza3NJblByb2plY3QoaW5ib3gpO1xuICAgICAgICAgICAgICAgIHVwZGF0ZUN1cnJlbnRQcm9qZWN0KCdJbmJveCcpOyAvLyBVcGRhdGVzIGN1cnJlbnQgd29ya2luZyBwcm9qZWN0IFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgXG59O1xuXG5mdW5jdGlvbiBjcmVhdGVQcm9qZWN0KG5hbWUpIHtcbiAgICBsZXQgbmV3UHJvamVjdCA9IG5ldyBQcm9qZWN0KG5hbWUpO1xuICAgIGFycmF5T2ZQcm9qZWN0cy5wdXNoKG5ld1Byb2plY3QpO1xuICAgIFxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250ZW50JykudGV4dENvbnRlbnQgPSAnJztcbiAgICBcbiAgICBsZXQgdGFza0luc2lkZVByb2plY3QgPSBUb2RvQnV0dG9uKG5ld1Byb2plY3QpO1xuICAgIG5ld1Byb2plY3QuYXJyYXlPZlRvZG9zLnB1c2godGFza0luc2lkZVByb2plY3QpO1xuICAgIFxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwcm9qZWN0cycsIEpTT04uc3RyaW5naWZ5KGFycmF5T2ZQcm9qZWN0cykpO1xuXG4gICAgaWYobmFtZSA9PSAnSW5ib3gnKSByZXR1cm4gbmV3UHJvamVjdDtcbiAgICAgICAgXG4gICAgdXBkYXRlUHJvamVjdHMoKTtcbn1cblxuZnVuY3Rpb24gdXBkYXRlUHJvamVjdHMoKSB7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3RzJykudGV4dENvbnRlbnQgPSAnJztcbiAgICBmb3IobGV0IGkgPSAxOyBpIDwgYXJyYXlPZlByb2plY3RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmKGFycmF5T2ZQcm9qZWN0c1tpXS5uYW1lICE9PSAnSW5ib3gnKXtcbiAgICAgICAgICAgIGxldCBwcm9qZWN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBwcm9qZWN0LmNsYXNzTmFtZSA9ICdwcm9qZWN0JztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3RzJykuYXBwZW5kQ2hpbGQocHJvamVjdCk7XG4gICAgICAgICAgICBwcm9qZWN0LnRleHRDb250ZW50ID0gYXJyYXlPZlByb2plY3RzW2ldLm5hbWU7XG4gICAgXG4gICAgICAgICAgICBsZXQgZGVsZXRlUHJvamVjdEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgICAgICAgICAgZGVsZXRlUHJvamVjdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdwcm9qZWN0X19idG4nKTtcbiAgICAgICAgICAgIGRlbGV0ZVByb2plY3RCdXR0b24udGV4dENvbnRlbnQgPSAneCc7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGRlbGV0ZVByb2plY3RCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgZGVsZXRlUHJvamVjdChhcnJheU9mUHJvamVjdHNbaV0pO1xuICAgICAgICAgICAgfSk7XG4gICAgXG4gICAgICAgICAgICBwcm9qZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNyZWF0ZUFsbFRhc2tzSW5Qcm9qZWN0KGFycmF5T2ZQcm9qZWN0c1tpXSk7XG4gICAgICAgICAgICB9KTtcbiAgICBcbiAgICAgICAgICAgIHByb2plY3QuYXBwZW5kQ2hpbGQoZGVsZXRlUHJvamVjdEJ1dHRvbik7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGdldERhdGUoKSB7XG4gICAgbGV0IHRvZGF5ID0gbmV3IERhdGUoKTtcbiAgICBsZXQgZGQgPSBTdHJpbmcodG9kYXkuZ2V0RGF0ZSgpKS5wYWRTdGFydCgyLCAnMCcpO1xuICAgIGxldCBtbSA9IFN0cmluZyh0b2RheS5nZXRNb250aCgpICsgMSkucGFkU3RhcnQoMiwgJzAnKTsgLy9KYW51YXJ5IGlzIDAhXG4gICAgbGV0IHl5eXkgPSB0b2RheS5nZXRGdWxsWWVhcigpO1xuXG4gICAgdG9kYXkgPSB5eXl5ICsgJy0nICsgbW0gKyAnLScgKyBkZDtcblxuICAgIHJldHVybiB0b2RheTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlVG9kYXlzVGFza3MoKSB7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRlbnQnKS50ZXh0Q29udGVudCA9ICcnO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jcmVhdGUtYnV0dG9uJykudGV4dENvbnRlbnQgPSAnJztcbiAgICBsZXQgdG9kYXlDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0b2RheUNvbnRhaW5lci5jbGFzc05hbWUgPSAndG9kYXknO1xuXG4gICAgbGV0IHRvZGF5ID0gZ2V0RGF0ZSgpO1xuXG4gICAgdXBkYXRlQ3VycmVudFByb2plY3QoJ1RvZGF5Jyk7XG4gICBcbiAgICBmb3IobGV0IGkgaW4gYXJyYXlPZlByb2plY3RzKSB7XG4gICAgICAgIGZvcihsZXQgZiA9IDE7IGYgPCBhcnJheU9mUHJvamVjdHNbaV0uYXJyYXlPZlRvZG9zLmxlbmd0aDsgZisrKSB7XG4gICAgICAgICAgICBpZihhcnJheU9mUHJvamVjdHNbaV0uYXJyYXlPZlRvZG9zW2ZdLmRhdGUgPT0gdG9kYXkpIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVBbGxUYXNrc0luUHJvamVjdChhcnJheU9mUHJvamVjdHNbaV0sIGYpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRvZGF5JykuYXBwZW5kQ2hpbGQodG9kYXlDb250YWluZXIpO1xufTtcblxuZnVuY3Rpb24gY3JlYXRlVXBjb21pbmdUYXNrcygpIHtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGVudCcpLnRleHRDb250ZW50ID0gJyc7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNyZWF0ZS1idXR0b24nKS50ZXh0Q29udGVudCA9ICcnO1xuICAgIGxldCB1cGNvbWluZ0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHVwY29taW5nQ29udGFpbmVyLmNsYXNzTmFtZSA9ICd1cGNvbWluZyc7XG5cbiAgICBsZXQgdG9kYXkgPSBuZXcgRGF0ZSgpO1xuXG4gICAgbGV0IGRkID0gU3RyaW5nKHRvZGF5LmdldERhdGUoKSkucGFkU3RhcnQoMiwgJzAnKTtcbiAgICBsZXQgbW0gPSBTdHJpbmcodG9kYXkuZ2V0TW9udGgoKSArIDEpLnBhZFN0YXJ0KDIsICcwJyk7IC8vSmFudWFyeSBpcyAwIVxuICAgIGxldCB5eXl5ID0gdG9kYXkuZ2V0RnVsbFllYXIoKTtcblxuICAgIHRvZGF5ID0geXl5eSArICcvJyArIG1tICsgJy8nICsgZGQ7ICAgXG5cbiAgICB1cGRhdGVDdXJyZW50UHJvamVjdCgnVXBjb21pbmcnKTtcblxuICAgIGZvcihsZXQgaSBpbiBhcnJheU9mUHJvamVjdHMpIHtcbiAgICAgICAgZm9yKGxldCBmID0gMTsgZiA8IGFycmF5T2ZQcm9qZWN0c1tpXS5hcnJheU9mVG9kb3MubGVuZ3RoOyBmKyspIHtcbiAgICAgICAgICAgIGlmKGFycmF5T2ZQcm9qZWN0c1tpXS5hcnJheU9mVG9kb3NbZl0uZGF0ZS5zdWJzdHIoMCwgNCkgPiB5eXl5KSB7XG4gICAgICAgICAgICAgICAgY3JlYXRlQWxsVGFza3NJblByb2plY3QoYXJyYXlPZlByb2plY3RzW2ldLCBmLCAndXBjb21pbmcnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKGFycmF5T2ZQcm9qZWN0c1tpXS5hcnJheU9mVG9kb3NbZl0uZGF0ZS5zdWJzdHIoMCwgNCkgPT0geXl5eSAmJlxuICAgICAgICAgICAgICAgYXJyYXlPZlByb2plY3RzW2ldLmFycmF5T2ZUb2Rvc1tmXS5kYXRlLnN1YnN0cig1LCAyKSA+IG1tKSB7XG4gICAgICAgICAgICAgICAgY3JlYXRlQWxsVGFza3NJblByb2plY3QoYXJyYXlPZlByb2plY3RzW2ldLCBmLCAndXBjb21pbmcnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmKGFycmF5T2ZQcm9qZWN0c1tpXS5hcnJheU9mVG9kb3NbZl0uZGF0ZS5zdWJzdHIoMCwgNCkgPT0geXl5eSAmJlxuICAgICAgICAgICAgICAgYXJyYXlPZlByb2plY3RzW2ldLmFycmF5T2ZUb2Rvc1tmXS5kYXRlLnN1YnN0cig1LCAyKSA9PSBtbSAmJlxuICAgICAgICAgICAgICAgYXJyYXlPZlByb2plY3RzW2ldLmFycmF5T2ZUb2Rvc1tmXS5kYXRlLnN1YnN0cig4LCAyKSA+IGRkKSB7XG4gICAgICAgICAgICAgICAgY3JlYXRlQWxsVGFza3NJblByb2plY3QoYXJyYXlPZlByb2plY3RzW2ldLCBmLCAndXBjb21pbmcnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy51cGNvbWluZycpLmFwcGVuZENoaWxkKHVwY29taW5nQ29udGFpbmVyKTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQWxsVGFza3NJblByb2plY3QocHJvamVjdCwgaW5kZXhPZlRvZGF5VGFzaywgb3JpZ2luKSB7XG4gICAgaWYgKCFpbmRleE9mVG9kYXlUYXNrKXtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRlbnQnKS50ZXh0Q29udGVudCA9ICcnO1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY3JlYXRlLWJ1dHRvbicpLnRleHRDb250ZW50ID0gJyc7XG4gICAgICAgIHVwZGF0ZUN1cnJlbnRQcm9qZWN0KHByb2plY3QpO1xuICAgIH0gXG4gICAgXG4gICAgZm9yKGxldCBmID0gMTsgZiA8PSBwcm9qZWN0LmFycmF5T2ZUb2Rvcy5sZW5ndGggLSAxOyBmKyspIHtcbiAgICAgICAgbGV0IHRhc2tPblRoZVNjcmVlbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0YXNrT25UaGVTY3JlZW4uY2xhc3NOYW1lID0gJ3Rhc2snO1xuICAgICAgICBcbiAgICAgICAgbGV0IGNoZWNrQm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGNoZWNrQm94LnRleHRDb250ZW50ID0gJyc7XG4gICAgICAgIGNoZWNrQm94LmNsYXNzTmFtZSA9ICdjaGVja2JveCc7XG4gICAgICAgIHRhc2tPblRoZVNjcmVlbi5hcHBlbmRDaGlsZChjaGVja0JveCk7XG5cbiAgICAgICAgbGV0IHRhc2tOYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRhc2tOYW1lLnRleHRDb250ZW50ID0gcHJvamVjdC5hcnJheU9mVG9kb3NbZl0ubmFtZTtcbiAgICAgICAgdGFza05hbWUuY2xhc3NOYW1lID0gJ3Rhc2tuYW1lJztcbiAgICAgICAgdGFza09uVGhlU2NyZWVuLmFwcGVuZENoaWxkKHRhc2tOYW1lKTtcblxuICAgICAgICBsZXQgcHJvamVjdEZhdGhlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBwcm9qZWN0RmF0aGVyLnRleHRDb250ZW50ID0gJ1Byb2plY3Q6ICcgKyBwcm9qZWN0Lm5hbWU7XG4gICAgICAgIHByb2plY3RGYXRoZXIuY2xhc3NOYW1lID0gJ2ZhdGhlci1wcm9qZWN0JztcbiAgICAgICAgdGFza09uVGhlU2NyZWVuLmFwcGVuZENoaWxkKHByb2plY3RGYXRoZXIpO1xuXG4gICAgICAgIGxldCBkZXNjcmlwdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBkZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHByb2plY3QuYXJyYXlPZlRvZG9zW2ZdLmRlc2NyaXB0aW9uO1xuICAgICAgICBkZXNjcmlwdGlvbi5jbGFzc05hbWUgPSAnZGVzY3JpcHRpb24nO1xuICAgICAgICB0YXNrT25UaGVTY3JlZW4uYXBwZW5kQ2hpbGQoZGVzY3JpcHRpb24pO1xuXG4gICAgICAgIGlmKHByb2plY3QuYXJyYXlPZlRvZG9zW2ZdLnByaW9yaXR5ID09IDEpIGNoZWNrQm94LnN0eWxlLmJhY2tncm91bmQgPSAncmVkJztcbiAgICAgICAgaWYocHJvamVjdC5hcnJheU9mVG9kb3NbZl0ucHJpb3JpdHkgPT0gMikgY2hlY2tCb3guc3R5bGUuYmFja2dyb3VuZCA9ICdvcmFuZ2UnO1xuICAgICAgICBpZihwcm9qZWN0LmFycmF5T2ZUb2Rvc1tmXS5wcmlvcml0eSA9PSAzKSBjaGVja0JveC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3llbGxvdyc7XG4gICAgICAgIGlmKHByb2plY3QuYXJyYXlPZlRvZG9zW2ZdLnByaW9yaXR5ID09IDApIGNoZWNrQm94LnN0eWxlLmJhY2tncm91bmQgPSAnd2hpdGUnO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgIGNoZWNrQm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgLy8gaWYgKCFpbmRleE9mVG9kYXlUYXNrKSBkZWxldGVUYXNrKHByb2plY3QsIGYpO1xuICAgICAgICAgICAgZGVsZXRlVGFzayhwcm9qZWN0LCBmKTtcbiAgICAgICAgICAgIC8vIGlmIChpbmRleE9mVG9kYXlUYXNrKSBkZWxldGVUYXNrKHByb2plY3QsIGYsIGluZGV4T2ZUb2RheVRhc2spO1xuICAgICAgICAgICAgaWYoIWluZGV4T2ZUb2RheVRhc2spe1xuICAgICAgICAgICAgICAgIGNyZWF0ZUFsbFRhc2tzSW5Qcm9qZWN0KHByb2plY3QpO1xuICAgICAgICAgICAgfWVsc2UgaWYoaW5kZXhPZlRvZGF5VGFzayAmJiBvcmlnaW4gPT0gJ3VwY29taW5nJyl7XG4gICAgICAgICAgICAgICAgY3JlYXRlVXBjb21pbmdUYXNrcygpO1xuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgY3JlYXRlVG9kYXlzVGFza3MoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vICghaW5kZXhPZlRvZGF5VGFzaykgPyBjcmVhdGVBbGxUYXNrc0luUHJvamVjdChwcm9qZWN0KSA6IGNyZWF0ZVRvZGF5c1Rhc2tzKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGxldCBkYXRlUGlja2VyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRhc2tPblRoZVNjcmVlbi5hcHBlbmRDaGlsZChkYXRlUGlja2VyKTtcbiAgICAgICAgZGF0ZVBpY2tlci5jbGFzc05hbWUgPSAnZGF0ZSc7XG4gICAgICAgIGRhdGVQaWNrZXIudGV4dENvbnRlbnQgPSBwcm9qZWN0LmFycmF5T2ZUb2Rvc1tmXS5kYXRlO1xuXG4gICAgICAgIGlmKGluZGV4T2ZUb2RheVRhc2spe1xuICAgICAgICAgICAgaWYoaW5kZXhPZlRvZGF5VGFzayA9PSBmKSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGVudCcpLmFwcGVuZENoaWxkKHRhc2tPblRoZVNjcmVlbik7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRlbnQnKS5hcHBlbmRDaGlsZCh0YXNrT25UaGVTY3JlZW4pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmKCFpbmRleE9mVG9kYXlUYXNrKSBUb2RvQnV0dG9uKHByb2plY3QpO1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwcm9qZWN0cycsIEpTT04uc3RyaW5naWZ5KGFycmF5T2ZQcm9qZWN0cykpO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVDdXJyZW50UHJvamVjdChwcm9qZWN0KSB7XG4gICAgKHByb2plY3QubmFtZSkgPyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdC1uYW1lJykudGV4dENvbnRlbnQgPSBwcm9qZWN0Lm5hbWUgOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdC1uYW1lJykudGV4dENvbnRlbnQgPSBwcm9qZWN0O1xufVxuXG5mdW5jdGlvbiBpbnB1dFByb2plY3ROYW1lKCkge1xuICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBpbnB1dFByb2plY3ROYW1lKTtcbiAgICBcbiAgICB2YXIgcHJvamVjdHNEaXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdHMnKTtcbiAgICBsZXQgY2xvc2VCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICBjbG9zZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdwcm9qZWN0c19fYnRuJywgJ3Byb2plY3RzX19idG4tLWNsb3NlJyk7XG4gICAgY2xvc2VCdXR0b24udGV4dENvbnRlbnQgPSAneCc7XG4gICAgY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIHByb2plY3RzRGl2LnJlbW92ZUNoaWxkKGlucHV0Rm9yUHJvamVjdE5hbWUpO1xuICAgICAgICBwcm9qZWN0c0Rpdi5yZW1vdmVDaGlsZChzdWJtaXRCdXR0b25Gb3JQcm9qZWN0TmFtZSk7XG4gICAgICAgIHByb2plY3RzRGl2LnJlbW92ZUNoaWxkKGNsb3NlQnV0dG9uKTtcbiAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGlucHV0UHJvamVjdE5hbWUpO1xuICAgIH0pO1xuICAgIFxuICAgIHZhciBpbnB1dEZvclByb2plY3ROYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICBpbnB1dEZvclByb2plY3ROYW1lLnNldEF0dHJpYnV0ZSgndHlwZScsICd0ZXh0Jyk7XG4gICAgaW5wdXRGb3JQcm9qZWN0TmFtZS5jbGFzc0xpc3QuYWRkKCdwcm9qZWN0c19fbmFtZS1pbnB1dCcpO1xuICAgIFxuICAgIHByb2plY3RzRGl2LmFwcGVuZENoaWxkKGlucHV0Rm9yUHJvamVjdE5hbWUpO1xuICAgIFxuICAgIHZhciBzdWJtaXRCdXR0b25Gb3JQcm9qZWN0TmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgIGNsb3NlQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3Byb2plY3RzX19idG4nLCAncHJvamVjdHNfX2J0bi0tc3VibWl0Jyk7XG5cbiAgICBwcm9qZWN0c0Rpdi5hcHBlbmRDaGlsZChjbG9zZUJ1dHRvbik7XG4gICAgcHJvamVjdHNEaXYuYXBwZW5kQ2hpbGQoc3VibWl0QnV0dG9uRm9yUHJvamVjdE5hbWUpO1xuICAgIHN1Ym1pdEJ1dHRvbkZvclByb2plY3ROYW1lLnRleHRDb250ZW50ID0gJ09rJztcblxuICAgIFxuICAgIHN1Ym1pdEJ1dHRvbkZvclByb2plY3ROYW1lLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBsZXQgbmFtZSA9IGlucHV0Rm9yUHJvamVjdE5hbWUudmFsdWU7XG4gICAgICAgIFxuICAgICAgICBpZihuYW1lICYmIG5hbWUubGVuZ3RoIDwgMTYgJiYgY2hlY2tJZGVudGljYWxQcm9qZWN0KG5hbWUpKSB7XG4gICAgICAgICAgICBwcm9qZWN0c0Rpdi5yZW1vdmVDaGlsZChpbnB1dEZvclByb2plY3ROYW1lKTtcbiAgICAgICAgICAgIHByb2plY3RzRGl2LnJlbW92ZUNoaWxkKHN1Ym1pdEJ1dHRvbkZvclByb2plY3ROYW1lKTtcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jcmVhdGUtYnV0dG9uJykudGV4dENvbnRlbnQgPSAnJztcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9qZWN0LW5hbWUnKS50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgICAgICAgICBjcmVhdGVQcm9qZWN0KG5hbWUpO1xuICAgICAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGlucHV0UHJvamVjdE5hbWUpO1xuICAgICAgICB9ZWxzZSBpZihjaGVja0lkZW50aWNhbFByb2plY3QobmFtZSkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIGFsZXJ0KCdQcm9qZWN0IG5hbWVzIHNob3VsZCBiZSBkaWZmZXJlbnQnKTtcbiAgICAgICAgICAgIGlucHV0Rm9yUHJvamVjdE5hbWUudmFsdWUgPSAnJztcbiAgICAgICAgfWVsc2UgaWYobmFtZS5sZW5ndGggPj0gMTYpe1xuICAgICAgICAgICAgYWxlcnQoJ1Byb2plY3QgbmFtZSBzaG91bGQgYmUgbGVzcyB0aGFuIDE2IGNoYXJhY3RlcnMnKTtcbiAgICAgICAgfWVsc2UgaWYoIW5hbWUpe1xuICAgICAgICAgICAgYWxlcnQoJ0VudGVyIHByb2plY3QgbmFtZScpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGNoZWNrSWRlbnRpY2FsUHJvamVjdChuYW1lKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheU9mUHJvamVjdHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYoYXJyYXlPZlByb2plY3RzW2ldLm5hbWUgPT0gbmFtZSkgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gZGVsZXRlVGFzayhuZXdQcm9qZWN0LCBudW1iZXJPZlRhc2spIHtcbiAgICBuZXdQcm9qZWN0LmFycmF5T2ZUb2Rvcy5zcGxpY2UobnVtYmVyT2ZUYXNrLCAxKTsgXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Byb2plY3RzJywgSlNPTi5zdHJpbmdpZnkoYXJyYXlPZlByb2plY3RzKSk7XG59XG5cbmZ1bmN0aW9uIGRlbGV0ZVByb2plY3QobmV3UHJvamVjdCkge1xuICAgIGZvcihsZXQgaSA9IDA7IGkgPCBhcnJheU9mUHJvamVjdHMubGVuZ3RoOyBpKyspe1xuICAgICAgICBpZihhcnJheU9mUHJvamVjdHNbaV0gPT0gbmV3UHJvamVjdCl7XG4gICAgICAgICAgICBhcnJheU9mUHJvamVjdHMuc3BsaWNlKGksIDEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwcm9qZWN0cycsIEpTT04uc3RyaW5naWZ5KGFycmF5T2ZQcm9qZWN0cykpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250ZW50JykudGV4dENvbnRlbnQgPSAnJztcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY3JlYXRlLWJ1dHRvbicpLnRleHRDb250ZW50ID0gJyc7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3QtbmFtZScpLnRleHRDb250ZW50ID0gJyc7XG4gICAgdXBkYXRlUHJvamVjdHMoKTtcbn1cblxuZXhwb3J0IHtpbnB1dFByb2plY3ROYW1lLCBjcmVhdGVBbGxUYXNrc0luUHJvamVjdCwgYXJyYXlPZlByb2plY3RzfSIsImltcG9ydCB7IFRvZG8gfSBmcm9tIFwiLi90b2Rvc1wiO1xuaW1wb3J0IHsgY3JlYXRlQWxsVGFza3NJblByb2plY3QsIGFycmF5T2ZQcm9qZWN0cyB9IGZyb20gXCIuL3VwZGF0ZVByb2plY3RzRE9NXCI7XG5cbmZ1bmN0aW9uIFRvZG9CdXR0b24obmV3UHJvamVjdCkge1xuICAgIGxldCB0b2RvQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICBcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY3JlYXRlLWJ1dHRvbicpLmFwcGVuZENoaWxkKHRvZG9CdXR0b24pO1xuICAgIHRvZG9CdXR0b24udGV4dENvbnRlbnQgPSAnQ3JlYXRlIHRvZG8nO1xuICAgIHRvZG9CdXR0b24uY2xhc3NOYW1lID0gJ2NyZWF0ZS1idXR0b25fX2J0bic7XG5cbiAgICB0b2RvQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBjcmVhdGVQb3B1cChuZXdQcm9qZWN0KTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlUG9wdXAobmV3UHJvamVjdCkge1xuICAgIC8vIHBvcHVwLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgIGxldCBwb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cC1jb250YWluZXInKTtcbiAgICBwb3B1cC5zdHlsZS50cmFuc2Zvcm0gPSAnc2NhbGUoMSknO1xuICAgIFxuICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0ID09IHBvcHVwKSB7XG4gICAgICAgICAgICBwb3B1cC5zdHlsZS50cmFuc2Zvcm0gPSAnc2NhbGUoMCknO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnN1Ym1pdC1idXR0b25cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGdldERhdGFGcm9tRm9ybSwgZmFsc2UpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc3VibWl0LWJ1dHRvblwiKS5wYXJhbWV0ZXIgPSBuZXdQcm9qZWN0O1xufVxuXG5mdW5jdGlvbiBnZXREYXRhRnJvbUZvcm0oZSkge1xuICAgIGxldCBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2tuYW1lJykudmFsdWU7XG4gICAgbGV0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rlc2NyaXB0aW9uJykudmFsdWU7XG4gICAgbGV0IGRhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGF0ZScpLnZhbHVlO1xuICAgIGxldCBwcmlvcml0eSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmlvcml0eScpLnZhbHVlO1xuXG4gICAgaWYgKG5hbWUpIHtcbiAgICAgICAgbGV0IHRhc2sgPSBUb2RvKG5hbWUsIGRlc2NyaXB0aW9uLCBkYXRlLCBwcmlvcml0eSlcbiAgICAgICAgZS5jdXJyZW50VGFyZ2V0LnBhcmFtZXRlci5hcnJheU9mVG9kb3MucHVzaCh0YXNrKTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Byb2plY3RzJywgSlNPTi5zdHJpbmdpZnkoYXJyYXlPZlByb2plY3RzKSk7XG5cbiAgICAgICAgbGV0IHBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwLWNvbnRhaW5lcicpO1xuICAgICAgICBwb3B1cC5zdHlsZS50cmFuc2Zvcm0gPSAnc2NhbGUoMCknO1xuXG4gICAgICAgIGNyZWF0ZUFsbFRhc2tzSW5Qcm9qZWN0KGUuY3VycmVudFRhcmdldC5wYXJhbWV0ZXIpO1xuICAgIH1lbHNlIHtcbiAgICAgICAgYWxlcnQoJ0VudGVyIHRhc2sgbmFtZScpO1xuICAgIH1cblxufVxuXG5leHBvcnQgeyBUb2RvQnV0dG9uIH0iLCJmdW5jdGlvbiBUb2RvKG5hbWUsIGRlc2NyaXB0aW9uLCBkYXRlLCBwcmlvcml0eSl7XG4gICAgcmV0dXJue1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24sXG4gICAgICAgIGRhdGU6IGRhdGUsXG4gICAgICAgIHByaW9yaXR5OiBwcmlvcml0eSxcbiAgICB9XG59XG5cbmV4cG9ydCB7VG9kb307IiwiaW1wb3J0IHsgY3JlYXRlVG9kbyB9IGZyb20gXCIuL3VwZGF0ZVRvZG9zRE9NXCI7XG5pbXBvcnQgeyBpbnB1dFByb2plY3ROYW1lIH0gZnJvbSBcIi4vdXBkYXRlUHJvamVjdHNET01cIjtcblxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3RzX19idG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGlucHV0UHJvamVjdE5hbWUpOyJdLCJuYW1lcyI6WyJQcm9qZWN0IiwiY29uc3RydWN0b3IiLCJuYW1lIiwidGhpcyIsImFycmF5T2ZUb2RvcyIsImFycmF5T2ZQcm9qZWN0cyIsImNyZWF0ZVByb2plY3QiLCJuZXdQcm9qZWN0IiwicHVzaCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInRleHRDb250ZW50IiwidGFza0luc2lkZVByb2plY3QiLCJUb2RvQnV0dG9uIiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1cGRhdGVQcm9qZWN0cyIsImkiLCJsZW5ndGgiLCJwcm9qZWN0IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsImFwcGVuZENoaWxkIiwiZGVsZXRlUHJvamVjdEJ1dHRvbiIsImNsYXNzTGlzdCIsImFkZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJkZWxldGVQcm9qZWN0IiwiY3JlYXRlQWxsVGFza3NJblByb2plY3QiLCJjcmVhdGVUb2RheXNUYXNrcyIsInRvZGF5Q29udGFpbmVyIiwidG9kYXkiLCJEYXRlIiwiZGQiLCJTdHJpbmciLCJnZXREYXRlIiwicGFkU3RhcnQiLCJtbSIsImdldE1vbnRoIiwieXl5eSIsImdldEZ1bGxZZWFyIiwidXBkYXRlQ3VycmVudFByb2plY3QiLCJmIiwiZGF0ZSIsImNyZWF0ZVVwY29taW5nVGFza3MiLCJ1cGNvbWluZ0NvbnRhaW5lciIsInN1YnN0ciIsImluZGV4T2ZUb2RheVRhc2siLCJvcmlnaW4iLCJ0YXNrT25UaGVTY3JlZW4iLCJjaGVja0JveCIsInRhc2tOYW1lIiwicHJvamVjdEZhdGhlciIsImRlc2NyaXB0aW9uIiwicHJpb3JpdHkiLCJzdHlsZSIsImJhY2tncm91bmQiLCJudW1iZXJPZlRhc2siLCJzcGxpY2UiLCJkYXRlUGlja2VyIiwiY2hlY2tJZGVudGljYWxQcm9qZWN0IiwidG9kb0J1dHRvbiIsInBvcHVwIiwidHJhbnNmb3JtIiwiYm9keSIsImV2ZW50IiwidGFyZ2V0IiwiZ2V0RGF0YUZyb21Gb3JtIiwicGFyYW1ldGVyIiwiY3JlYXRlUG9wdXAiLCJlIiwiZ2V0RWxlbWVudEJ5SWQiLCJ2YWx1ZSIsInRhc2siLCJUb2RvIiwiY3VycmVudFRhcmdldCIsImFsZXJ0IiwiY29uc29sZSIsImxvZyIsInBhcnNlIiwiZ2V0SXRlbSIsImluYm94IiwiY3JlYXRlSW5ib3giLCJpbnB1dFByb2plY3ROYW1lIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInByb2plY3RzRGl2IiwiY2xvc2VCdXR0b24iLCJyZW1vdmVDaGlsZCIsImlucHV0Rm9yUHJvamVjdE5hbWUiLCJzdWJtaXRCdXR0b25Gb3JQcm9qZWN0TmFtZSIsInNldEF0dHJpYnV0ZSJdLCJzb3VyY2VSb290IjoiIn0=