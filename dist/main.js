(()=>{"use strict";class e{constructor(e){this.name=e,this.arrayOfTodos=[]}}let t=[];function n(){document.querySelector(".projects").textContent="",t.forEach((e=>{let o=0,r=document.createElement("div");r.className="project",r.textContent=e.name;let c=document.createElement("button");c.classList.add("project__btn"),c.textContent="x",c.addEventListener("click",(()=>{var r;document.querySelector(".create-button").textContent="",r=e,t=t.filter((e=>e!==r)),localStorage.setItem("projects",JSON.stringify(t)),n(),document.querySelector(".content").textContent="",o=1})),r.addEventListener("click",(()=>{0==o&&a(e)})),r.appendChild(c),"Inbox"!==e.name&&document.querySelector(".projects").appendChild(r)}))}function o(){document.querySelector(".content").textContent="",document.querySelector(".create-button").textContent="";let e=document.createElement("div");e.className="today";let n=function(){let e=new Date,t=String(e.getDate()).padStart(2,"0"),n=String(e.getMonth()+1).padStart(2,"0"),o=e.getFullYear();return e=o+"-"+n+"-"+t,e}();c("Today"),t.forEach((e=>{for(let t in e.arrayOfTodos)e.arrayOfTodos[t]&&e.arrayOfTodos[t].date==n&&a(e,t)})),document.querySelector(".today").appendChild(e)}function r(){document.querySelector(".content").textContent="",document.querySelector(".create-button").textContent="";let e=document.createElement("div");e.className="upcoming";let n=new Date,o=String(n.getDate()).padStart(2,"0"),r=String(n.getMonth()+1).padStart(2,"0"),d=n.getFullYear();n=d+"/"+r+"/"+o,c("Upcoming");for(let e in t)for(let n=1;n<t[e].arrayOfTodos.length;n++)t[e].arrayOfTodos[n].date.substr(0,4)>d&&a(t[e],n,"upcoming"),t[e].arrayOfTodos[n].date.substr(0,4)==d&&t[e].arrayOfTodos[n].date.substr(5,2)>r&&a(t[e],n,"upcoming"),t[e].arrayOfTodos[n].date.substr(0,4)==d&&t[e].arrayOfTodos[n].date.substr(5,2)==r&&t[e].arrayOfTodos[n].date.substr(8,2)>o&&a(t[e],n,"upcoming");document.querySelector(".upcoming").appendChild(e)}function a(e,n,d){n||(document.querySelector(".content").textContent="",document.querySelector(".create-button").textContent="",c(e));for(let c=1;c<e.arrayOfTodos.length;c++){let l=document.createElement("div");l.className="task";let s=document.createElement("div");s.textContent="",s.className="task__checkbox",l.appendChild(s);let i=document.createElement("div");i.textContent=e.arrayOfTodos[c].name,i.className="task__name",l.appendChild(i);let u=document.createElement("div");u.textContent="Project: "+e.name,u.className="task__origin",l.appendChild(u);let m=document.createElement("div");m.textContent=e.arrayOfTodos[c].description,m.className="task__description",l.appendChild(m),1==e.arrayOfTodos[c].priority&&(s.style.background="red"),2==e.arrayOfTodos[c].priority&&(s.style.background="orange"),3==e.arrayOfTodos[c].priority&&(s.style.background="yellow"),0==e.arrayOfTodos[c].priority&&(s.style.background="white"),s.addEventListener("click",(()=>{var l;l=c,e.arrayOfTodos.splice(l,1),localStorage.setItem("projects",JSON.stringify(t)),n?n&&"upcoming"==d?r():o():a(e)}));let p=document.createElement("div");l.appendChild(p),p.className="task__date",p.textContent=e.arrayOfTodos[c].date,n?n==c&&document.querySelector(".content").appendChild(l):document.querySelector(".content").appendChild(l)}n||l(e),localStorage.setItem("projects",JSON.stringify(t))}function c(e){e.name?document.querySelector(".project-name").textContent=e.name:document.querySelector(".project-name").textContent=e}function d(e){for(let n in t)if(t[n].name==e)return!0;return!1}function l(e){let t=document.createElement("button");document.querySelector(".create-button").appendChild(t),t.textContent="Create todo",t.className="create-button__btn",t.addEventListener("click",(()=>{!function(e){let t=document.querySelector(".popup-container");t.style.transform="scale(1)",document.body.addEventListener("click",(function(e){e.target==t&&(t.style.transform="scale(0)")})),document.querySelector(".form__submit-button").addEventListener("click",s,!1),document.querySelector(".form__submit-button").parameter=e}(e)}))}function s(e){let n=document.getElementById("taskname").value,o=document.getElementById("description").value,r=document.getElementById("date").value,c=document.getElementById("priority").value;if(n){let d=function(e,t,n,o){return{name:e,description:t,date:n,priority:o}}(n,o,r,c);e.currentTarget.parameter.arrayOfTodos.push(d),localStorage.setItem("projects",JSON.stringify(t)),document.querySelector(".popup-container").style.transform="scale(0)",a(e.currentTarget.parameter)}else alert("Enter task name")}"projects"in localStorage&&(t=JSON.parse(localStorage.getItem("projects")||[])),function(){c("Inbox");let n=new e("Inbox");0==t.filter((e=>"Inbox"==e.name)).length&&t.push(n),l(n),localStorage.setItem("projects",JSON.stringify(t)),t.filter((e=>"Inbox"==e.name)).length>0?a(t[0]):a(n),document.querySelector(".inbox").addEventListener("click",(()=>{console.log(t),t.filter((e=>"Inbox"==e.name)).length>0?a(t[0]):a(n)}))}(),n(),document.querySelector(".today").addEventListener("click",o),document.querySelector(".upcoming").addEventListener("click",r),document.querySelector(".projects__btn").addEventListener("click",(function o(){this.removeEventListener("click",o);var r=document.querySelector(".projects");let a=document.createElement("button");a.classList.add("projects__btn","projects__btn--close"),a.textContent="x",a.addEventListener("click",(()=>{r.removeChild(c),r.removeChild(s),r.removeChild(a),this.addEventListener("click",o)}));var c=document.createElement("input");c.setAttribute("type","text"),c.classList.add("projects__name-input"),r.appendChild(c);var s=document.createElement("button");a.classList.add("projects__btn","projects__btn--submit"),r.appendChild(a),r.appendChild(s),s.textContent="Ok",s.addEventListener("click",(()=>{let a=c.value;a&&a.length<16&&!d(a)?(r.removeChild(c),r.removeChild(s),document.querySelector(".create-button").textContent="",document.querySelector(".project-name").textContent=a,function(o){let r=new e(o);t.push(r),document.querySelector(".content").textContent="";let a=l(r);if(r.arrayOfTodos.push(a),localStorage.setItem("projects",JSON.stringify(t)),"Inbox"==o)return r;n()}(a),this.addEventListener("click",o)):1==d(a)?(alert("Project names should be different"),c.value=""):a.length>=16?alert("Project name should be less than 16 characters"):a||alert("Enter project name")}))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QnJGLFNBQVNPLGNBQWMsVUFDeEQyRSxFQUFZeEUsVUFBVUMsSUFBSSxnQkFBaUIseUJBRTNDc0UsRUFBWTdELFlBQVk4RCxHQUN4QkQsRUFBWTdELFlBQVlpRSxHQUN4QkEsRUFBMkJuRixZQUFjLEtBR3pDbUYsRUFBMkJ6RSxpQkFBaUIsU0FBUyxLQUNqRCxJQUFJakIsRUFBT3lGLEVBQW9CakIsTUFFNUJ4RSxHQUFRQSxFQUFLNEMsT0FBUyxLQUFPZ0IsRUFBc0I1RCxJQUNsRHNGLEVBQVlFLFlBQVlDLEdBQ3hCSCxFQUFZRSxZQUFZRSxHQUN4QnJGLFNBQVNDLGNBQWMsa0JBQWtCQyxZQUFjLEdBQ3ZERixTQUFTQyxjQUFjLGlCQUFpQkMsWUFBY1AsRUExTmxFLFNBQXVCQSxHQUNuQixJQUFJa0IsRUFBYSxJQUFJcEIsRUFBUUUsR0FDN0JHLEVBQWdCeUUsS0FBSzFELEdBRXJCYixTQUFTQyxjQUFjLFlBQVlDLFlBQWMsR0FFakQsSUFBSXFGLEVBQW9CakMsRUFBV3pDLEdBS25DLEdBSkFBLEVBQVdoQixhQUFhMEUsS0FBS2dCLEdBRTdCeEUsYUFBYUMsUUFBUSxXQUFZQyxLQUFLQyxVQUFVcEIsSUFFckMsU0FBUkgsRUFBaUIsT0FBT2tCLEVBRTNCZCxJQThNUXlGLENBQWM3RixHQUNkQyxLQUFLZ0IsaUJBQWlCLFFBQVNtRSxJQUNLLEdBQS9CeEIsRUFBc0I1RCxJQUMzQjZFLE1BQU0scUNBQ05ZLEVBQW9CakIsTUFBUSxJQUN2QnhFLEVBQUs0QyxRQUFVLEdBQ3BCaUMsTUFBTSxrREFDQTdFLEdBQ042RSxNQUFNLDZCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGFja2FnZS8uL3NyYy9wcm9qZWN0cy5qcyIsIndlYnBhY2s6Ly9wYWNrYWdlLy4vc3JjL3VwZGF0ZVByb2plY3RzRE9NLmpzIiwid2VicGFjazovL3BhY2thZ2UvLi9zcmMvdXBkYXRlVG9kb3NET00uanMiLCJ3ZWJwYWNrOi8vcGFja2FnZS8uL3NyYy90b2Rvcy5qcyIsIndlYnBhY2s6Ly9wYWNrYWdlLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFByb2plY3R7XG4gICAgY29uc3RydWN0b3IobmFtZSl7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMuYXJyYXlPZlRvZG9zID0gW107XG4gICAgfVxuICAgIFxuICAgIC8vZnVuY3Rpb25zIHRvIGFsdGVyIHRhc2tzIGluc2lkZSBhIHByb2plY3Rcbn1cblxuZXhwb3J0IHtQcm9qZWN0fTsiLCJpbXBvcnQgeyBQcm9qZWN0IH0gZnJvbSBcIi4vcHJvamVjdHNcIjtcbmltcG9ydCB7IFRvZG9CdXR0b24gfSBmcm9tIFwiLi91cGRhdGVUb2Rvc0RPTVwiO1xuaW1wb3J0IHsgZm9ybWF0RHVyYXRpb24sIGludGVydmFsVG9EdXJhdGlvbiB9IGZyb20gJ2RhdGUtZm5zJztcblxubGV0IGFycmF5T2ZQcm9qZWN0cyA9IFtdO1xuXG4oZnVuY3Rpb24gY2hlY2tQcm9qZWN0c09uUmVsb2FkKCkge1xuICAgIGlmKCdwcm9qZWN0cycgaW4gbG9jYWxTdG9yYWdlKXtcbiAgICAgICAgYXJyYXlPZlByb2plY3RzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncHJvamVjdHMnKSB8fCBbXSk7XG4gICAgfWVsc2V7XG4gICAgfVxuICAgIGNyZWF0ZUluYm94KCk7XG4gICAgXG4gICAgdXBkYXRlUHJvamVjdHMoKTtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudG9kYXknKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNyZWF0ZVRvZGF5c1Rhc2tzKTtcbiAgICBcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudXBjb21pbmcnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNyZWF0ZVVwY29taW5nVGFza3MpO1xufSkoKTtcblxuZnVuY3Rpb24gY3JlYXRlSW5ib3goKSB7XG4gICAgdXBkYXRlQ3VycmVudFByb2plY3QoJ0luYm94Jyk7IC8vIFVwZGF0ZXMgY3VycmVudCB3b3JraW5nIHByb2plY3QgXG4gICAgXG4gICAgbGV0IGluYm94ID0gbmV3IFByb2plY3QoJ0luYm94Jyk7XG4gICAgaWYoYXJyYXlPZlByb2plY3RzLmZpbHRlcihwcm9qZWN0ID0+IHByb2plY3QubmFtZSA9PSAnSW5ib3gnKS5sZW5ndGggPT0gMCkgYXJyYXlPZlByb2plY3RzLnB1c2goaW5ib3gpO1xuICAgIFxuICAgIFRvZG9CdXR0b24oaW5ib3gpO1xuICAgIC8vIGluYm94LmFycmF5T2ZUb2Rvcy5wdXNoKHRhc2tJbnNpZGVJbmJveCk7XG4gICAgXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Byb2plY3RzJywgSlNPTi5zdHJpbmdpZnkoYXJyYXlPZlByb2plY3RzKSk7XG5cbiAgICAoYXJyYXlPZlByb2plY3RzLmZpbHRlcihwcm9qZWN0ID0+IHByb2plY3QubmFtZSA9PSAnSW5ib3gnKS5sZW5ndGggPiAwKSA/IGNyZWF0ZUFsbFRhc2tzSW5Qcm9qZWN0KGFycmF5T2ZQcm9qZWN0c1swXSkgOiBjcmVhdGVBbGxUYXNrc0luUHJvamVjdChpbmJveCk7XG4gICAgXG4gICAgLy8gaGVyZSBpcyB0aGUgdHJpY2suIHRoZSBpbmJveCBjcmVhdGVkIGZvciB0aGUgc2Vjb25kIHRpbWUgZG9lcyBub3QgaGF2ZSBhbnkgdGFza3NcbiAgICBcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaW5ib3gnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coYXJyYXlPZlByb2plY3RzKTtcbiAgICAgICAgKGFycmF5T2ZQcm9qZWN0cy5maWx0ZXIocHJvamVjdCA9PiBwcm9qZWN0Lm5hbWUgPT0gJ0luYm94JykubGVuZ3RoID4gMCkgPyBjcmVhdGVBbGxUYXNrc0luUHJvamVjdChhcnJheU9mUHJvamVjdHNbMF0pIDogY3JlYXRlQWxsVGFza3NJblByb2plY3QoaW5ib3gpO1xuICAgIH0pO1xufTtcblxuZnVuY3Rpb24gY3JlYXRlUHJvamVjdChuYW1lKSB7XG4gICAgbGV0IG5ld1Byb2plY3QgPSBuZXcgUHJvamVjdChuYW1lKTtcbiAgICBhcnJheU9mUHJvamVjdHMucHVzaChuZXdQcm9qZWN0KTtcbiAgICBcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGVudCcpLnRleHRDb250ZW50ID0gJyc7XG4gICAgXG4gICAgbGV0IHRhc2tJbnNpZGVQcm9qZWN0ID0gVG9kb0J1dHRvbihuZXdQcm9qZWN0KTtcbiAgICBuZXdQcm9qZWN0LmFycmF5T2ZUb2Rvcy5wdXNoKHRhc2tJbnNpZGVQcm9qZWN0KTtcbiAgICBcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJvamVjdHMnLCBKU09OLnN0cmluZ2lmeShhcnJheU9mUHJvamVjdHMpKTtcblxuICAgIGlmKG5hbWUgPT0gJ0luYm94JykgcmV0dXJuIG5ld1Byb2plY3Q7XG4gICAgICAgIFxuICAgIHVwZGF0ZVByb2plY3RzKCk7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZVByb2plY3RzKCkge1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9qZWN0cycpLnRleHRDb250ZW50ID0gJyc7XG4gICAgXG4gICAgYXJyYXlPZlByb2plY3RzLmZvckVhY2gocHJvamVjdEluQXJyYXkgPT4ge1xuICAgICAgICBsZXQgZGVsZXRlQnV0dG9uSW5kZXggPSAwO1xuICAgICAgICBsZXQgcHJvamVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBwcm9qZWN0LmNsYXNzTmFtZSA9ICdwcm9qZWN0JztcbiAgICAgICAgICAgIFxuICAgICAgICBwcm9qZWN0LnRleHRDb250ZW50ID0gcHJvamVjdEluQXJyYXkubmFtZTtcbiAgICAgICAgXG4gICAgICAgIGxldCBkZWxldGVQcm9qZWN0QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgIGRlbGV0ZVByb2plY3RCdXR0b24uY2xhc3NMaXN0LmFkZCgncHJvamVjdF9fYnRuJyk7XG4gICAgICAgIGRlbGV0ZVByb2plY3RCdXR0b24udGV4dENvbnRlbnQgPSAneCc7XG4gICAgICAgIFxuICAgICAgICBkZWxldGVQcm9qZWN0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNyZWF0ZS1idXR0b24nKS50ZXh0Q29udGVudCA9ICcnO1xuICAgICAgICAgICAgZGVsZXRlUHJvamVjdChwcm9qZWN0SW5BcnJheSk7XG4gICAgICAgICAgICBkZWxldGVCdXR0b25JbmRleCA9IDE7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgcHJvamVjdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIGlmKGRlbGV0ZUJ1dHRvbkluZGV4ID09IDApIGNyZWF0ZUFsbFRhc2tzSW5Qcm9qZWN0KHByb2plY3RJbkFycmF5KTtcbiAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgcHJvamVjdC5hcHBlbmRDaGlsZChkZWxldGVQcm9qZWN0QnV0dG9uKTtcbiAgICAgICAgaWYocHJvamVjdEluQXJyYXkubmFtZSAhPT0gJ0luYm94Jyl7XG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdHMnKS5hcHBlbmRDaGlsZChwcm9qZWN0KTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBnZXREYXRlKCkge1xuICAgIGxldCB0b2RheSA9IG5ldyBEYXRlKCk7XG4gICAgbGV0IGRkID0gU3RyaW5nKHRvZGF5LmdldERhdGUoKSkucGFkU3RhcnQoMiwgJzAnKTtcbiAgICBsZXQgbW0gPSBTdHJpbmcodG9kYXkuZ2V0TW9udGgoKSArIDEpLnBhZFN0YXJ0KDIsICcwJyk7IC8vSmFudWFyeSBpcyAwIVxuICAgIGxldCB5eXl5ID0gdG9kYXkuZ2V0RnVsbFllYXIoKTtcblxuICAgIHRvZGF5ID0geXl5eSArICctJyArIG1tICsgJy0nICsgZGQ7XG5cbiAgICByZXR1cm4gdG9kYXk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVRvZGF5c1Rhc2tzKCkge1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250ZW50JykudGV4dENvbnRlbnQgPSAnJztcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY3JlYXRlLWJ1dHRvbicpLnRleHRDb250ZW50ID0gJyc7XG4gICAgXG4gICAgbGV0IHRvZGF5Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdG9kYXlDb250YWluZXIuY2xhc3NOYW1lID0gJ3RvZGF5JztcblxuICAgIGxldCB0b2RheSA9IGdldERhdGUoKTtcblxuICAgIHVwZGF0ZUN1cnJlbnRQcm9qZWN0KCdUb2RheScpO1xuXG4gICAgYXJyYXlPZlByb2plY3RzLmZvckVhY2gocHJvamVjdCA9PiB7XG4gICAgICAgIGZvciAobGV0IGYgaW4gcHJvamVjdC5hcnJheU9mVG9kb3MpIHtcbiAgICAgICAgICAgIGlmKHByb2plY3QuYXJyYXlPZlRvZG9zW2ZdKXtcbiAgICAgICAgICAgICAgICBpZihwcm9qZWN0LmFycmF5T2ZUb2Rvc1tmXS5kYXRlID09IHRvZGF5KSB7XG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZUFsbFRhc2tzSW5Qcm9qZWN0KHByb2plY3QsIGYpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRvZGF5JykuYXBwZW5kQ2hpbGQodG9kYXlDb250YWluZXIpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVVcGNvbWluZ1Rhc2tzKCkge1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250ZW50JykudGV4dENvbnRlbnQgPSAnJztcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY3JlYXRlLWJ1dHRvbicpLnRleHRDb250ZW50ID0gJyc7XG4gICAgbGV0IHVwY29taW5nQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdXBjb21pbmdDb250YWluZXIuY2xhc3NOYW1lID0gJ3VwY29taW5nJztcblxuICAgIGxldCB0b2RheSA9IG5ldyBEYXRlKCk7XG5cbiAgICBsZXQgZGQgPSBTdHJpbmcodG9kYXkuZ2V0RGF0ZSgpKS5wYWRTdGFydCgyLCAnMCcpO1xuICAgIGxldCBtbSA9IFN0cmluZyh0b2RheS5nZXRNb250aCgpICsgMSkucGFkU3RhcnQoMiwgJzAnKTsgLy9KYW51YXJ5IGlzIDAhXG4gICAgbGV0IHl5eXkgPSB0b2RheS5nZXRGdWxsWWVhcigpO1xuXG4gICAgdG9kYXkgPSB5eXl5ICsgJy8nICsgbW0gKyAnLycgKyBkZDsgICBcblxuICAgIHVwZGF0ZUN1cnJlbnRQcm9qZWN0KCdVcGNvbWluZycpO1xuXG4gICAgZm9yKGxldCBpIGluIGFycmF5T2ZQcm9qZWN0cykge1xuICAgICAgICBmb3IobGV0IGYgPSAxOyBmIDwgYXJyYXlPZlByb2plY3RzW2ldLmFycmF5T2ZUb2Rvcy5sZW5ndGg7IGYrKykge1xuICAgICAgICAgICAgaWYoYXJyYXlPZlByb2plY3RzW2ldLmFycmF5T2ZUb2Rvc1tmXS5kYXRlLnN1YnN0cigwLCA0KSA+IHl5eXkpIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVBbGxUYXNrc0luUHJvamVjdChhcnJheU9mUHJvamVjdHNbaV0sIGYsICd1cGNvbWluZycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoYXJyYXlPZlByb2plY3RzW2ldLmFycmF5T2ZUb2Rvc1tmXS5kYXRlLnN1YnN0cigwLCA0KSA9PSB5eXl5ICYmXG4gICAgICAgICAgICAgICBhcnJheU9mUHJvamVjdHNbaV0uYXJyYXlPZlRvZG9zW2ZdLmRhdGUuc3Vic3RyKDUsIDIpID4gbW0pIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVBbGxUYXNrc0luUHJvamVjdChhcnJheU9mUHJvamVjdHNbaV0sIGYsICd1cGNvbWluZycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoYXJyYXlPZlByb2plY3RzW2ldLmFycmF5T2ZUb2Rvc1tmXS5kYXRlLnN1YnN0cigwLCA0KSA9PSB5eXl5ICYmXG4gICAgICAgICAgICAgICBhcnJheU9mUHJvamVjdHNbaV0uYXJyYXlPZlRvZG9zW2ZdLmRhdGUuc3Vic3RyKDUsIDIpID09IG1tICYmXG4gICAgICAgICAgICAgICBhcnJheU9mUHJvamVjdHNbaV0uYXJyYXlPZlRvZG9zW2ZdLmRhdGUuc3Vic3RyKDgsIDIpID4gZGQpIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVBbGxUYXNrc0luUHJvamVjdChhcnJheU9mUHJvamVjdHNbaV0sIGYsICd1cGNvbWluZycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnVwY29taW5nJykuYXBwZW5kQ2hpbGQodXBjb21pbmdDb250YWluZXIpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVBbGxUYXNrc0luUHJvamVjdChwcm9qZWN0LCBpbmRleE9mVG9kYXlUYXNrLCBvcmlnaW4pIHtcbiAgICBpZiAoIWluZGV4T2ZUb2RheVRhc2spe1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGVudCcpLnRleHRDb250ZW50ID0gJyc7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jcmVhdGUtYnV0dG9uJykudGV4dENvbnRlbnQgPSAnJztcbiAgICAgICAgdXBkYXRlQ3VycmVudFByb2plY3QocHJvamVjdCk7XG4gICAgfVxuXG4gICAgZm9yKGxldCBmID0gMTsgZiA8IHByb2plY3QuYXJyYXlPZlRvZG9zLmxlbmd0aDsgZisrKSB7XG4gICAgICAgIGxldCB0YXNrT25UaGVTY3JlZW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdGFza09uVGhlU2NyZWVuLmNsYXNzTmFtZSA9ICd0YXNrJztcbiAgICAgICAgXG4gICAgICAgIGxldCBjaGVja0JveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBjaGVja0JveC50ZXh0Q29udGVudCA9ICcnO1xuICAgICAgICBjaGVja0JveC5jbGFzc05hbWUgPSAndGFza19fY2hlY2tib3gnO1xuICAgICAgICB0YXNrT25UaGVTY3JlZW4uYXBwZW5kQ2hpbGQoY2hlY2tCb3gpO1xuXG4gICAgICAgIGxldCB0YXNrTmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0YXNrTmFtZS50ZXh0Q29udGVudCA9IHByb2plY3QuYXJyYXlPZlRvZG9zW2ZdLm5hbWU7XG4gICAgICAgIHRhc2tOYW1lLmNsYXNzTmFtZSA9ICd0YXNrX19uYW1lJztcbiAgICAgICAgdGFza09uVGhlU2NyZWVuLmFwcGVuZENoaWxkKHRhc2tOYW1lKTtcblxuICAgICAgICBsZXQgdGFza09yaWdpbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0YXNrT3JpZ2luLnRleHRDb250ZW50ID0gJ1Byb2plY3Q6ICcgKyBwcm9qZWN0Lm5hbWU7XG4gICAgICAgIHRhc2tPcmlnaW4uY2xhc3NOYW1lID0gJ3Rhc2tfX29yaWdpbic7XG4gICAgICAgIHRhc2tPblRoZVNjcmVlbi5hcHBlbmRDaGlsZCh0YXNrT3JpZ2luKTtcblxuICAgICAgICBsZXQgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgZGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBwcm9qZWN0LmFycmF5T2ZUb2Rvc1tmXS5kZXNjcmlwdGlvbjtcbiAgICAgICAgZGVzY3JpcHRpb24uY2xhc3NOYW1lID0gJ3Rhc2tfX2Rlc2NyaXB0aW9uJztcbiAgICAgICAgdGFza09uVGhlU2NyZWVuLmFwcGVuZENoaWxkKGRlc2NyaXB0aW9uKTtcblxuICAgICAgICBpZihwcm9qZWN0LmFycmF5T2ZUb2Rvc1tmXS5wcmlvcml0eSA9PSAxKSBjaGVja0JveC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3JlZCc7XG4gICAgICAgIGlmKHByb2plY3QuYXJyYXlPZlRvZG9zW2ZdLnByaW9yaXR5ID09IDIpIGNoZWNrQm94LnN0eWxlLmJhY2tncm91bmQgPSAnb3JhbmdlJztcbiAgICAgICAgaWYocHJvamVjdC5hcnJheU9mVG9kb3NbZl0ucHJpb3JpdHkgPT0gMykgY2hlY2tCb3guc3R5bGUuYmFja2dyb3VuZCA9ICd5ZWxsb3cnO1xuICAgICAgICBpZihwcm9qZWN0LmFycmF5T2ZUb2Rvc1tmXS5wcmlvcml0eSA9PSAwKSBjaGVja0JveC5zdHlsZS5iYWNrZ3JvdW5kID0gJ3doaXRlJztcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICBjaGVja0JveC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIGRlbGV0ZVRhc2socHJvamVjdCwgZik7XG4gICAgICAgICAgICBpZighaW5kZXhPZlRvZGF5VGFzaykge1xuICAgICAgICAgICAgICAgIGNyZWF0ZUFsbFRhc2tzSW5Qcm9qZWN0KHByb2plY3QpO1xuICAgICAgICAgICAgfWVsc2UgaWYoaW5kZXhPZlRvZGF5VGFzayAmJiBvcmlnaW4gPT0gJ3VwY29taW5nJykge1xuICAgICAgICAgICAgICAgIGNyZWF0ZVVwY29taW5nVGFza3MoKTtcbiAgICAgICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVUb2RheXNUYXNrcygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgZGF0ZVBpY2tlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICB0YXNrT25UaGVTY3JlZW4uYXBwZW5kQ2hpbGQoZGF0ZVBpY2tlcik7XG4gICAgICAgIGRhdGVQaWNrZXIuY2xhc3NOYW1lID0gJ3Rhc2tfX2RhdGUnO1xuICAgICAgICBkYXRlUGlja2VyLnRleHRDb250ZW50ID0gcHJvamVjdC5hcnJheU9mVG9kb3NbZl0uZGF0ZTtcblxuICAgICAgICBpZihpbmRleE9mVG9kYXlUYXNrKSB7XG4gICAgICAgICAgICBpZihpbmRleE9mVG9kYXlUYXNrID09IGYpIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250ZW50JykuYXBwZW5kQ2hpbGQodGFza09uVGhlU2NyZWVuKTtcbiAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRlbnQnKS5hcHBlbmRDaGlsZCh0YXNrT25UaGVTY3JlZW4pO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmKCFpbmRleE9mVG9kYXlUYXNrKSBUb2RvQnV0dG9uKHByb2plY3QpO1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwcm9qZWN0cycsIEpTT04uc3RyaW5naWZ5KGFycmF5T2ZQcm9qZWN0cykpO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVDdXJyZW50UHJvamVjdChwcm9qZWN0KSB7XG4gICAgKHByb2plY3QubmFtZSkgPyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdC1uYW1lJykudGV4dENvbnRlbnQgPSBwcm9qZWN0Lm5hbWUgOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdC1uYW1lJykudGV4dENvbnRlbnQgPSBwcm9qZWN0O1xufVxuXG5mdW5jdGlvbiBpbnB1dFByb2plY3ROYW1lKCkge1xuICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBpbnB1dFByb2plY3ROYW1lKTtcbiAgICBcbiAgICB2YXIgcHJvamVjdHNEaXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdHMnKTtcbiAgICBsZXQgY2xvc2VCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICBjbG9zZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdwcm9qZWN0c19fYnRuJywgJ3Byb2plY3RzX19idG4tLWNsb3NlJyk7XG4gICAgY2xvc2VCdXR0b24udGV4dENvbnRlbnQgPSAneCc7XG4gICAgY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIHByb2plY3RzRGl2LnJlbW92ZUNoaWxkKGlucHV0Rm9yUHJvamVjdE5hbWUpO1xuICAgICAgICBwcm9qZWN0c0Rpdi5yZW1vdmVDaGlsZChzdWJtaXRCdXR0b25Gb3JQcm9qZWN0TmFtZSk7XG4gICAgICAgIHByb2plY3RzRGl2LnJlbW92ZUNoaWxkKGNsb3NlQnV0dG9uKTtcbiAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGlucHV0UHJvamVjdE5hbWUpO1xuICAgIH0pO1xuICAgIFxuICAgIHZhciBpbnB1dEZvclByb2plY3ROYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcbiAgICBpbnB1dEZvclByb2plY3ROYW1lLnNldEF0dHJpYnV0ZSgndHlwZScsICd0ZXh0Jyk7XG4gICAgaW5wdXRGb3JQcm9qZWN0TmFtZS5jbGFzc0xpc3QuYWRkKCdwcm9qZWN0c19fbmFtZS1pbnB1dCcpO1xuICAgIFxuICAgIHByb2plY3RzRGl2LmFwcGVuZENoaWxkKGlucHV0Rm9yUHJvamVjdE5hbWUpO1xuICAgIFxuICAgIHZhciBzdWJtaXRCdXR0b25Gb3JQcm9qZWN0TmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgIGNsb3NlQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3Byb2plY3RzX19idG4nLCAncHJvamVjdHNfX2J0bi0tc3VibWl0Jyk7XG5cbiAgICBwcm9qZWN0c0Rpdi5hcHBlbmRDaGlsZChjbG9zZUJ1dHRvbik7XG4gICAgcHJvamVjdHNEaXYuYXBwZW5kQ2hpbGQoc3VibWl0QnV0dG9uRm9yUHJvamVjdE5hbWUpO1xuICAgIHN1Ym1pdEJ1dHRvbkZvclByb2plY3ROYW1lLnRleHRDb250ZW50ID0gJ09rJztcblxuICAgIFxuICAgIHN1Ym1pdEJ1dHRvbkZvclByb2plY3ROYW1lLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBsZXQgbmFtZSA9IGlucHV0Rm9yUHJvamVjdE5hbWUudmFsdWU7XG4gICAgICAgIFxuICAgICAgICBpZihuYW1lICYmIG5hbWUubGVuZ3RoIDwgMTYgJiYgIWNoZWNrSWRlbnRpY2FsUHJvamVjdChuYW1lKSkge1xuICAgICAgICAgICAgcHJvamVjdHNEaXYucmVtb3ZlQ2hpbGQoaW5wdXRGb3JQcm9qZWN0TmFtZSk7XG4gICAgICAgICAgICBwcm9qZWN0c0Rpdi5yZW1vdmVDaGlsZChzdWJtaXRCdXR0b25Gb3JQcm9qZWN0TmFtZSk7XG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY3JlYXRlLWJ1dHRvbicpLnRleHRDb250ZW50ID0gJyc7XG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdC1uYW1lJykudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgICAgICAgICAgY3JlYXRlUHJvamVjdChuYW1lKTtcbiAgICAgICAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBpbnB1dFByb2plY3ROYW1lKTtcbiAgICAgICAgfWVsc2UgaWYoY2hlY2tJZGVudGljYWxQcm9qZWN0KG5hbWUpID09IHRydWUpIHtcbiAgICAgICAgICAgIGFsZXJ0KCdQcm9qZWN0IG5hbWVzIHNob3VsZCBiZSBkaWZmZXJlbnQnKTtcbiAgICAgICAgICAgIGlucHV0Rm9yUHJvamVjdE5hbWUudmFsdWUgPSAnJztcbiAgICAgICAgfWVsc2UgaWYobmFtZS5sZW5ndGggPj0gMTYpe1xuICAgICAgICAgICAgYWxlcnQoJ1Byb2plY3QgbmFtZSBzaG91bGQgYmUgbGVzcyB0aGFuIDE2IGNoYXJhY3RlcnMnKTtcbiAgICAgICAgfWVsc2UgaWYoIW5hbWUpe1xuICAgICAgICAgICAgYWxlcnQoJ0VudGVyIHByb2plY3QgbmFtZScpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGNoZWNrSWRlbnRpY2FsUHJvamVjdChuYW1lKSB7XG4gICAgLy8gYXJyYXlPZlByb2plY3RzLmZvckVhY2gocHJvamVjdCA9PiBwcm9qZWN0Lm5hbWUgPT0gbmFtZSk7XG4gICAgZm9yIChsZXQgaSBpbiBhcnJheU9mUHJvamVjdHMpIHtcbiAgICAgICAgaWYoYXJyYXlPZlByb2plY3RzW2ldLm5hbWUgPT0gbmFtZSkgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24gZGVsZXRlVGFzayhuZXdQcm9qZWN0LCBudW1iZXJPZlRhc2spIHtcbiAgICBuZXdQcm9qZWN0LmFycmF5T2ZUb2Rvcy5zcGxpY2UobnVtYmVyT2ZUYXNrLCAxKTsgXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Byb2plY3RzJywgSlNPTi5zdHJpbmdpZnkoYXJyYXlPZlByb2plY3RzKSk7XG59XG5cbmZ1bmN0aW9uIGRlbGV0ZVByb2plY3QobmV3UHJvamVjdCkge1xuICAgIGFycmF5T2ZQcm9qZWN0cyA9IGFycmF5T2ZQcm9qZWN0cy5maWx0ZXIocHJvamVjdCA9PiBwcm9qZWN0ICE9PSBuZXdQcm9qZWN0KTtcblxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwcm9qZWN0cycsIEpTT04uc3RyaW5naWZ5KGFycmF5T2ZQcm9qZWN0cykpO1xuXG4gICAgdXBkYXRlUHJvamVjdHMoKTtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGVudCcpLnRleHRDb250ZW50ID0gJyc7XG59XG5cbmV4cG9ydCB7aW5wdXRQcm9qZWN0TmFtZSwgY3JlYXRlQWxsVGFza3NJblByb2plY3QsIGFycmF5T2ZQcm9qZWN0c30iLCJpbXBvcnQgeyBUb2RvIH0gZnJvbSBcIi4vdG9kb3NcIjtcbmltcG9ydCB7IGNyZWF0ZUFsbFRhc2tzSW5Qcm9qZWN0LCBhcnJheU9mUHJvamVjdHMgfSBmcm9tIFwiLi91cGRhdGVQcm9qZWN0c0RPTVwiO1xuXG5mdW5jdGlvbiBUb2RvQnV0dG9uKG5ld1Byb2plY3QpIHtcbiAgICBsZXQgdG9kb0J1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNyZWF0ZS1idXR0b24nKS5hcHBlbmRDaGlsZCh0b2RvQnV0dG9uKTtcbiAgICB0b2RvQnV0dG9uLnRleHRDb250ZW50ID0gJ0NyZWF0ZSB0b2RvJztcbiAgICB0b2RvQnV0dG9uLmNsYXNzTmFtZSA9ICdjcmVhdGUtYnV0dG9uX19idG4nO1xuXG4gICAgdG9kb0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgY3JlYXRlUG9wdXAobmV3UHJvamVjdCk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVBvcHVwKG5ld1Byb2plY3QpIHtcbiAgICAvLyBwb3B1cC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICBsZXQgcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXAtY29udGFpbmVyJyk7XG4gICAgcG9wdXAuc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlKDEpJztcbiAgICBcbiAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldCA9PSBwb3B1cCkge1xuICAgICAgICAgICAgcG9wdXAuc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlKDApJztcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fc3VibWl0LWJ1dHRvblwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZ2V0RGF0YUZyb21Gb3JtLCBmYWxzZSk7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtX19zdWJtaXQtYnV0dG9uXCIpLnBhcmFtZXRlciA9IG5ld1Byb2plY3Q7XG59XG5cbmZ1bmN0aW9uIGdldERhdGFGcm9tRm9ybShlKSB7XG4gICAgbGV0IG5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFza25hbWUnKS52YWx1ZTtcbiAgICBsZXQgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVzY3JpcHRpb24nKS52YWx1ZTtcbiAgICBsZXQgZGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYXRlJykudmFsdWU7XG4gICAgbGV0IHByaW9yaXR5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ByaW9yaXR5JykudmFsdWU7XG5cbiAgICBpZiAobmFtZSkge1xuICAgICAgICBsZXQgdGFzayA9IFRvZG8obmFtZSwgZGVzY3JpcHRpb24sIGRhdGUsIHByaW9yaXR5KVxuICAgICAgICBlLmN1cnJlbnRUYXJnZXQucGFyYW1ldGVyLmFycmF5T2ZUb2Rvcy5wdXNoKHRhc2spO1xuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJvamVjdHMnLCBKU09OLnN0cmluZ2lmeShhcnJheU9mUHJvamVjdHMpKTtcblxuICAgICAgICBsZXQgcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXAtY29udGFpbmVyJyk7XG4gICAgICAgIHBvcHVwLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZSgwKSc7XG5cbiAgICAgICAgY3JlYXRlQWxsVGFza3NJblByb2plY3QoZS5jdXJyZW50VGFyZ2V0LnBhcmFtZXRlcik7XG4gICAgfWVsc2Uge1xuICAgICAgICBhbGVydCgnRW50ZXIgdGFzayBuYW1lJyk7XG4gICAgfVxuXG59XG5cbmV4cG9ydCB7IFRvZG9CdXR0b24gfSIsImZ1bmN0aW9uIFRvZG8obmFtZSwgZGVzY3JpcHRpb24sIGRhdGUsIHByaW9yaXR5KXtcbiAgICByZXR1cm57XG4gICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcbiAgICAgICAgZGF0ZTogZGF0ZSxcbiAgICAgICAgcHJpb3JpdHk6IHByaW9yaXR5LFxuICAgIH1cbn1cblxuZXhwb3J0IHtUb2RvfTsiLCJpbXBvcnQgeyBjcmVhdGVUb2RvIH0gZnJvbSBcIi4vdXBkYXRlVG9kb3NET01cIjtcbmltcG9ydCB7IGlucHV0UHJvamVjdE5hbWUgfSBmcm9tIFwiLi91cGRhdGVQcm9qZWN0c0RPTVwiO1xuXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdHNfX2J0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaW5wdXRQcm9qZWN0TmFtZSk7Il0sIm5hbWVzIjpbIlByb2plY3QiLCJjb25zdHJ1Y3RvciIsIm5hbWUiLCJ0aGlzIiwiYXJyYXlPZlRvZG9zIiwiYXJyYXlPZlByb2plY3RzIiwidXBkYXRlUHJvamVjdHMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJ0ZXh0Q29udGVudCIsImZvckVhY2giLCJwcm9qZWN0SW5BcnJheSIsImRlbGV0ZUJ1dHRvbkluZGV4IiwicHJvamVjdCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJkZWxldGVQcm9qZWN0QnV0dG9uIiwiY2xhc3NMaXN0IiwiYWRkIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm5ld1Byb2plY3QiLCJmaWx0ZXIiLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsImNyZWF0ZUFsbFRhc2tzSW5Qcm9qZWN0IiwiYXBwZW5kQ2hpbGQiLCJjcmVhdGVUb2RheXNUYXNrcyIsInRvZGF5Q29udGFpbmVyIiwidG9kYXkiLCJEYXRlIiwiZGQiLCJTdHJpbmciLCJnZXREYXRlIiwicGFkU3RhcnQiLCJtbSIsImdldE1vbnRoIiwieXl5eSIsImdldEZ1bGxZZWFyIiwidXBkYXRlQ3VycmVudFByb2plY3QiLCJmIiwiZGF0ZSIsImNyZWF0ZVVwY29taW5nVGFza3MiLCJ1cGNvbWluZ0NvbnRhaW5lciIsImkiLCJsZW5ndGgiLCJzdWJzdHIiLCJpbmRleE9mVG9kYXlUYXNrIiwib3JpZ2luIiwidGFza09uVGhlU2NyZWVuIiwiY2hlY2tCb3giLCJ0YXNrTmFtZSIsInRhc2tPcmlnaW4iLCJkZXNjcmlwdGlvbiIsInByaW9yaXR5Iiwic3R5bGUiLCJiYWNrZ3JvdW5kIiwibnVtYmVyT2ZUYXNrIiwic3BsaWNlIiwiZGF0ZVBpY2tlciIsIlRvZG9CdXR0b24iLCJjaGVja0lkZW50aWNhbFByb2plY3QiLCJ0b2RvQnV0dG9uIiwicG9wdXAiLCJ0cmFuc2Zvcm0iLCJib2R5IiwiZXZlbnQiLCJ0YXJnZXQiLCJnZXREYXRhRnJvbUZvcm0iLCJwYXJhbWV0ZXIiLCJjcmVhdGVQb3B1cCIsImUiLCJnZXRFbGVtZW50QnlJZCIsInZhbHVlIiwidGFzayIsIlRvZG8iLCJjdXJyZW50VGFyZ2V0IiwicHVzaCIsImFsZXJ0IiwicGFyc2UiLCJnZXRJdGVtIiwiaW5ib3giLCJjb25zb2xlIiwibG9nIiwiY3JlYXRlSW5ib3giLCJpbnB1dFByb2plY3ROYW1lIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInByb2plY3RzRGl2IiwiY2xvc2VCdXR0b24iLCJyZW1vdmVDaGlsZCIsImlucHV0Rm9yUHJvamVjdE5hbWUiLCJzdWJtaXRCdXR0b25Gb3JQcm9qZWN0TmFtZSIsInNldEF0dHJpYnV0ZSIsInRhc2tJbnNpZGVQcm9qZWN0IiwiY3JlYXRlUHJvamVjdCJdLCJzb3VyY2VSb290IjoiIn0=