(()=>{"use strict";class e{constructor(e){this.name=e,this.arrayOfTodos=[]}}let t=[];function n(){document.querySelector(".projects").textContent="";for(let e=1;e<t.length;e++)if("Inbox"!==t[e].name){let n=document.createElement("div");n.className="project",document.querySelector(".projects").appendChild(n),n.textContent=t[e].name;let o=document.createElement("button");o.classList.add("project__btn"),o.textContent="x",o.addEventListener("click",(()=>{d(t[e])})),n.addEventListener("click",(()=>{c(t[e])})),n.appendChild(o)}}function o(){document.querySelector(".content").textContent="",document.querySelector(".create-button").textContent="";let e=document.createElement("div");e.className="today";let n=function(){let e=new Date,t=String(e.getDate()).padStart(2,"0"),n=String(e.getMonth()+1).padStart(2,"0"),o=e.getFullYear();return e=o+"-"+n+"-"+t,e}();a("Today");for(let e in t)for(let o=1;o<t[e].arrayOfTodos.length;o++)t[e].arrayOfTodos[o].date==n&&c(t[e],o);document.querySelector(".today").appendChild(e)}function r(){document.querySelector(".content").textContent="",document.querySelector(".create-button").textContent="";let e=document.createElement("div");e.className="upcoming";let n=new Date,o=String(n.getDate()).padStart(2,"0"),r=String(n.getMonth()+1).padStart(2,"0"),l=n.getFullYear();n=l+"/"+r+"/"+o,a("Upcoming");for(let e in t)for(let n=1;n<t[e].arrayOfTodos.length;n++)t[e].arrayOfTodos[n].date.substr(0,4)>l&&c(t[e],n,"upcoming"),t[e].arrayOfTodos[n].date.substr(0,4)==l&&t[e].arrayOfTodos[n].date.substr(5,2)>r&&c(t[e],n,"upcoming"),t[e].arrayOfTodos[n].date.substr(0,4)==l&&t[e].arrayOfTodos[n].date.substr(5,2)==r&&t[e].arrayOfTodos[n].date.substr(8,2)>o&&c(t[e],n,"upcoming");document.querySelector(".upcoming").appendChild(e)}function c(e,n,l){n||(document.querySelector(".content").textContent="",document.querySelector(".create-button").textContent="",a(e));for(let a=1;a<=e.arrayOfTodos.length-1;a++){let d=document.createElement("div");d.className="task";let s=document.createElement("div");s.textContent="",s.className="checkbox",d.appendChild(s);let u=document.createElement("div");u.textContent=e.arrayOfTodos[a].name,u.className="taskname",d.appendChild(u);let i=document.createElement("div");i.textContent="Project: "+e.name,i.className="father-project",d.appendChild(i);let m=document.createElement("div");m.textContent=e.arrayOfTodos[a].description,m.className="description",d.appendChild(m),1==e.arrayOfTodos[a].priority&&(s.style.background="red"),2==e.arrayOfTodos[a].priority&&(s.style.background="orange"),3==e.arrayOfTodos[a].priority&&(s.style.background="yellow"),0==e.arrayOfTodos[a].priority&&(s.style.background="white"),s.addEventListener("click",(()=>{var d;d=a,e.arrayOfTodos.splice(d,1),localStorage.setItem("projects",JSON.stringify(t)),n?n&&"upcoming"==l?r():o():c(e)}));let p=document.createElement("div");d.appendChild(p),p.className="date",p.textContent=e.arrayOfTodos[a].date,n?n==a&&document.querySelector(".content").appendChild(d):document.querySelector(".content").appendChild(d)}n||s(e),localStorage.setItem("projects",JSON.stringify(t))}function a(e){e.name?document.querySelector(".project-name").textContent=e.name:document.querySelector(".project-name").textContent=e}function l(e){for(let n=0;n<t.length;n++)if(t[n].name==e)return!1;return!0}function d(e){for(let n=0;n<t.length;n++)t[n]==e&&t.splice(n,1);localStorage.setItem("projects",JSON.stringify(t)),document.querySelector(".content").textContent="",document.querySelector(".create-button").textContent="",document.querySelector(".project-name").textContent="",n()}function s(e){let t=document.createElement("button");document.querySelector(".create-button").appendChild(t),t.textContent="Create todo",t.className="create-button__btn",t.addEventListener("click",(()=>{!function(e){let t=document.querySelector(".popup-container");t.style.transform="scale(1)",document.body.addEventListener("click",(function(e){e.target==t&&(t.style.transform="scale(0)")})),document.querySelector(".submit-button").addEventListener("click",u,!1),document.querySelector(".submit-button").parameter=e}(e)}))}function u(e){let n=document.getElementById("taskname").value,o=document.getElementById("description").value,r=document.getElementById("date").value,a=document.getElementById("priority").value;if(n){let l=function(e,t,n,o){return{name:e,description:t,date:n,priority:o}}(n,o,r,a);e.currentTarget.parameter.arrayOfTodos.push(l),localStorage.setItem("projects",JSON.stringify(t)),document.querySelector(".popup-container").style.transform="scale(0)",c(e.currentTarget.parameter)}else alert("Enter task name")}"projects"in localStorage&&(t=JSON.parse(localStorage.getItem("projects")||[]),n()),function(){let n=new e("Inbox");console.log(l(n)),document.querySelector(".inbox").addEventListener("click",(()=>{c(n),a("Inbox")})),t.push(n);let o=s(n);n.arrayOfTodos.push(o),localStorage.setItem("projects",JSON.stringify(t)),console.log(t),c(n)}(),document.querySelector(".today").addEventListener("click",o),document.querySelector(".upcoming").addEventListener("click",r),document.querySelector(".projects__btn").addEventListener("click",(function o(){this.removeEventListener("click",o);var r=document.querySelector(".projects");let c=document.createElement("button");c.classList.add("projects__btn","projects__btn--close"),c.textContent="x",c.addEventListener("click",(()=>{r.removeChild(a),r.removeChild(d),r.removeChild(c),this.addEventListener("click",o)}));var a=document.createElement("input");a.setAttribute("type","text"),a.classList.add("projects__name-input"),r.appendChild(a);var d=document.createElement("button");c.classList.add("projects__btn","projects__btn--submit"),r.appendChild(c),r.appendChild(d),d.textContent="Ok",d.addEventListener("click",(()=>{let c=a.value;c&&c.length<16&&l(c)?(r.removeChild(a),r.removeChild(d),document.querySelector(".create-button").textContent="",document.querySelector(".project-name").textContent=c,function(o){let r=new e(o);t.push(r),document.querySelector(".content").textContent="";let c=s(r);r.arrayOfTodos.push(c),localStorage.setItem("projects",JSON.stringify(t)),n()}(c),this.addEventListener("click",o)):0==l(c)?(alert("Project names should be different"),a.value=""):c.length>=16?alert("Project name should be less than 16 characters"):c||alert("Enter project name")}))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dkUsWUFBWTBFLEdBRXhCLElBQUlDLEVBQTZCbkYsU0FBU00sY0FBYyxVQUN4RDBFLEVBQVl0RSxVQUFVQyxJQUFJLGdCQUFpQix5QkFFM0NvRSxFQUFZdkUsWUFBWXdFLEdBQ3hCRCxFQUFZdkUsWUFBWTJFLEdBQ3hCQSxFQUEyQmpGLFlBQWMsS0FHekNpRixFQUEyQnZFLGlCQUFpQixTQUFTLEtBQ2pELElBQUlqQixFQUFPdUYsRUFBb0JsQixNQUU1QnJFLEdBQVFBLEVBQUtTLE9BQVMsSUFBTStDLEVBQXNCeEQsSUFDakRvRixFQUFZRSxZQUFZQyxHQUN4QkgsRUFBWUUsWUFBWUUsR0FDeEJuRixTQUFTQyxjQUFjLGtCQUFrQkMsWUFBYyxHQUN2REYsU0FBU0MsY0FBYyxpQkFBaUJDLFlBQWNQLEVBdE5sRSxTQUF1QkEsR0FDbkIsSUFBSXlELEVBQWEsSUFBSTNELEVBQVFFLEdBQzdCRyxFQUFnQnNFLEtBQUtoQixHQUVyQnBELFNBQVNDLGNBQWMsWUFBWUMsWUFBYyxHQUVqRCxJQUFJbUYsRUFBb0JuQyxFQUFXRSxHQUNuQ0EsRUFBV3ZELGFBQWF1RSxLQUFLaUIsR0FFN0J4QyxhQUFhQyxRQUFRLFdBQVlDLEtBQUtDLFVBQVVsRCxJQUVoREMsSUE0TVF1RixDQUFjM0YsR0FDZEMsS0FBS2dCLGlCQUFpQixRQUFTaUUsSUFDSyxHQUEvQjFCLEVBQXNCeEQsSUFDM0IwRSxNQUFNLHFDQUNOYSxFQUFvQmxCLE1BQVEsSUFDdkJyRSxFQUFLUyxRQUFVLEdBQ3BCaUUsTUFBTSxrREFDQTFFLEdBQ04wRSxNQUFNLDZCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGFja2FnZS8uL3NyYy9wcm9qZWN0cy5qcyIsIndlYnBhY2s6Ly9wYWNrYWdlLy4vc3JjL3VwZGF0ZVByb2plY3RzRE9NLmpzIiwid2VicGFjazovL3BhY2thZ2UvLi9zcmMvdXBkYXRlVG9kb3NET00uanMiLCJ3ZWJwYWNrOi8vcGFja2FnZS8uL3NyYy90b2Rvcy5qcyIsIndlYnBhY2s6Ly9wYWNrYWdlLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIFByb2plY3R7XG4gICAgY29uc3RydWN0b3IobmFtZSl7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMuYXJyYXlPZlRvZG9zID0gW107XG4gICAgfVxuICAgIFxuICAgIC8vZnVuY3Rpb25zIHRvIGFsdGVyIHRhc2tzIGluc2lkZSBhIHByb2plY3Rcbn1cblxuZXhwb3J0IHtQcm9qZWN0fTsiLCJpbXBvcnQgeyBQcm9qZWN0IH0gZnJvbSBcIi4vcHJvamVjdHNcIjtcbmltcG9ydCB7IFRvZG9CdXR0b24gfSBmcm9tIFwiLi91cGRhdGVUb2Rvc0RPTVwiO1xuXG5sZXQgYXJyYXlPZlByb2plY3RzID0gW107XG5cbihmdW5jdGlvbiBjaGVja1Byb2plY3RzT25SZWxvYWQoKSB7XG4gICAgaWYoJ3Byb2plY3RzJyBpbiBsb2NhbFN0b3JhZ2Upe1xuICAgICAgICBhcnJheU9mUHJvamVjdHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdwcm9qZWN0cycpIHx8IFtdKTtcbiAgICAgICAgdXBkYXRlUHJvamVjdHMoKTtcbiAgICB9XG4gICAgY3JlYXRlSW5ib3goKTtcbiAgICAgICAgICAgIFxuICAgIFxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50b2RheScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY3JlYXRlVG9kYXlzVGFza3MpO1xuICAgIFxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy51cGNvbWluZycpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY3JlYXRlVXBjb21pbmdUYXNrcyk7XG59KSgpO1xuXG5mdW5jdGlvbiBjcmVhdGVJbmJveCgpIHtcbiAgICBsZXQgaW5ib3ggPSBuZXcgUHJvamVjdCgnSW5ib3gnKTtcbiAgICBjb25zb2xlLmxvZyhjaGVja0lkZW50aWNhbFByb2plY3QoaW5ib3gpKTtcbiAgICBcbiAgICAvLyBpZiAoIWNoZWNrSWRlbnRpY2FsUHJvamVjdChpbmJveCkpIHtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmluYm94JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBjcmVhdGVBbGxUYXNrc0luUHJvamVjdChpbmJveCk7XG4gICAgICAgICAgICB1cGRhdGVDdXJyZW50UHJvamVjdCgnSW5ib3gnKTsgLy8gVXBkYXRlcyBjdXJyZW50IHdvcmtpbmcgcHJvamVjdCBcbiAgICAgICAgfSk7XG5cbiAgICAgICAgYXJyYXlPZlByb2plY3RzLnB1c2goaW5ib3gpO1xuICAgICAgICBcbiAgICAgICAgbGV0IHRhc2tJbnNpZGVJbmJveCA9IFRvZG9CdXR0b24oaW5ib3gpO1xuICAgICAgICBpbmJveC5hcnJheU9mVG9kb3MucHVzaCh0YXNrSW5zaWRlSW5ib3gpO1xuICAgICAgICBcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Byb2plY3RzJywgSlNPTi5zdHJpbmdpZnkoYXJyYXlPZlByb2plY3RzKSk7XG4gICAgICAgIGNvbnNvbGUubG9nKGFycmF5T2ZQcm9qZWN0cyk7XG4gICAgXG4gICAgICAgIGNyZWF0ZUFsbFRhc2tzSW5Qcm9qZWN0KGluYm94KTtcbiAgICAvLyB9XG4gICAgXG5cbn1cblxuZnVuY3Rpb24gY3JlYXRlUHJvamVjdChuYW1lKSB7XG4gICAgbGV0IG5ld1Byb2plY3QgPSBuZXcgUHJvamVjdChuYW1lKTtcbiAgICBhcnJheU9mUHJvamVjdHMucHVzaChuZXdQcm9qZWN0KTtcbiAgICBcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGVudCcpLnRleHRDb250ZW50ID0gJyc7XG4gICAgXG4gICAgbGV0IHRhc2tJbnNpZGVQcm9qZWN0ID0gVG9kb0J1dHRvbihuZXdQcm9qZWN0KTtcbiAgICBuZXdQcm9qZWN0LmFycmF5T2ZUb2Rvcy5wdXNoKHRhc2tJbnNpZGVQcm9qZWN0KTtcbiAgICBcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJvamVjdHMnLCBKU09OLnN0cmluZ2lmeShhcnJheU9mUHJvamVjdHMpKTtcbiAgICAgICAgXG4gICAgdXBkYXRlUHJvamVjdHMoKTtcbn1cblxuXG5mdW5jdGlvbiB1cGRhdGVQcm9qZWN0cygpIHtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdHMnKS50ZXh0Q29udGVudCA9ICcnO1xuICAgIGZvcihsZXQgaSA9IDE7IGkgPCBhcnJheU9mUHJvamVjdHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYoYXJyYXlPZlByb2plY3RzW2ldLm5hbWUgIT09ICdJbmJveCcpe1xuICAgICAgICAgICAgbGV0IHByb2plY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIHByb2plY3QuY2xhc3NOYW1lID0gJ3Byb2plY3QnO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdHMnKS5hcHBlbmRDaGlsZChwcm9qZWN0KTtcbiAgICAgICAgICAgIHByb2plY3QudGV4dENvbnRlbnQgPSBhcnJheU9mUHJvamVjdHNbaV0ubmFtZTtcbiAgICBcbiAgICAgICAgICAgIGxldCBkZWxldGVQcm9qZWN0QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgICAgICBkZWxldGVQcm9qZWN0QnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3Byb2plY3RfX2J0bicpO1xuICAgICAgICAgICAgZGVsZXRlUHJvamVjdEJ1dHRvbi50ZXh0Q29udGVudCA9ICd4JztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZGVsZXRlUHJvamVjdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICBkZWxldGVQcm9qZWN0KGFycmF5T2ZQcm9qZWN0c1tpXSk7XG4gICAgICAgICAgICB9KTtcbiAgICBcbiAgICAgICAgICAgIHByb2plY3QuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY3JlYXRlQWxsVGFza3NJblByb2plY3QoYXJyYXlPZlByb2plY3RzW2ldKTtcbiAgICAgICAgICAgIH0pO1xuICAgIFxuICAgICAgICAgICAgcHJvamVjdC5hcHBlbmRDaGlsZChkZWxldGVQcm9qZWN0QnV0dG9uKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gZ2V0RGF0ZSgpIHtcbiAgICBsZXQgdG9kYXkgPSBuZXcgRGF0ZSgpO1xuICAgIGxldCBkZCA9IFN0cmluZyh0b2RheS5nZXREYXRlKCkpLnBhZFN0YXJ0KDIsICcwJyk7XG4gICAgbGV0IG1tID0gU3RyaW5nKHRvZGF5LmdldE1vbnRoKCkgKyAxKS5wYWRTdGFydCgyLCAnMCcpOyAvL0phbnVhcnkgaXMgMCFcbiAgICBsZXQgeXl5eSA9IHRvZGF5LmdldEZ1bGxZZWFyKCk7XG5cbiAgICB0b2RheSA9IHl5eXkgKyAnLScgKyBtbSArICctJyArIGRkO1xuXG4gICAgcmV0dXJuIHRvZGF5O1xufVxuXG5mdW5jdGlvbiBjcmVhdGVUb2RheXNUYXNrcygpIHtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGVudCcpLnRleHRDb250ZW50ID0gJyc7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNyZWF0ZS1idXR0b24nKS50ZXh0Q29udGVudCA9ICcnO1xuICAgIGxldCB0b2RheUNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRvZGF5Q29udGFpbmVyLmNsYXNzTmFtZSA9ICd0b2RheSc7XG5cbiAgICBsZXQgdG9kYXkgPSBnZXREYXRlKCk7XG5cbiAgICB1cGRhdGVDdXJyZW50UHJvamVjdCgnVG9kYXknKTtcbiAgIFxuICAgIGZvcihsZXQgaSBpbiBhcnJheU9mUHJvamVjdHMpIHtcbiAgICAgICAgZm9yKGxldCBmID0gMTsgZiA8IGFycmF5T2ZQcm9qZWN0c1tpXS5hcnJheU9mVG9kb3MubGVuZ3RoOyBmKyspIHtcbiAgICAgICAgICAgIGlmKGFycmF5T2ZQcm9qZWN0c1tpXS5hcnJheU9mVG9kb3NbZl0uZGF0ZSA9PSB0b2RheSkge1xuICAgICAgICAgICAgICAgIGNyZWF0ZUFsbFRhc2tzSW5Qcm9qZWN0KGFycmF5T2ZQcm9qZWN0c1tpXSwgZik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudG9kYXknKS5hcHBlbmRDaGlsZCh0b2RheUNvbnRhaW5lcik7XG59O1xuXG5mdW5jdGlvbiBjcmVhdGVVcGNvbWluZ1Rhc2tzKCkge1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250ZW50JykudGV4dENvbnRlbnQgPSAnJztcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY3JlYXRlLWJ1dHRvbicpLnRleHRDb250ZW50ID0gJyc7XG4gICAgbGV0IHVwY29taW5nQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdXBjb21pbmdDb250YWluZXIuY2xhc3NOYW1lID0gJ3VwY29taW5nJztcblxuICAgIGxldCB0b2RheSA9IG5ldyBEYXRlKCk7XG5cbiAgICBsZXQgZGQgPSBTdHJpbmcodG9kYXkuZ2V0RGF0ZSgpKS5wYWRTdGFydCgyLCAnMCcpO1xuICAgIGxldCBtbSA9IFN0cmluZyh0b2RheS5nZXRNb250aCgpICsgMSkucGFkU3RhcnQoMiwgJzAnKTsgLy9KYW51YXJ5IGlzIDAhXG4gICAgbGV0IHl5eXkgPSB0b2RheS5nZXRGdWxsWWVhcigpO1xuXG4gICAgdG9kYXkgPSB5eXl5ICsgJy8nICsgbW0gKyAnLycgKyBkZDsgICBcblxuICAgIHVwZGF0ZUN1cnJlbnRQcm9qZWN0KCdVcGNvbWluZycpO1xuXG4gICAgZm9yKGxldCBpIGluIGFycmF5T2ZQcm9qZWN0cykge1xuICAgICAgICBmb3IobGV0IGYgPSAxOyBmIDwgYXJyYXlPZlByb2plY3RzW2ldLmFycmF5T2ZUb2Rvcy5sZW5ndGg7IGYrKykge1xuICAgICAgICAgICAgaWYoYXJyYXlPZlByb2plY3RzW2ldLmFycmF5T2ZUb2Rvc1tmXS5kYXRlLnN1YnN0cigwLCA0KSA+IHl5eXkpIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVBbGxUYXNrc0luUHJvamVjdChhcnJheU9mUHJvamVjdHNbaV0sIGYsICd1cGNvbWluZycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoYXJyYXlPZlByb2plY3RzW2ldLmFycmF5T2ZUb2Rvc1tmXS5kYXRlLnN1YnN0cigwLCA0KSA9PSB5eXl5ICYmXG4gICAgICAgICAgICAgICBhcnJheU9mUHJvamVjdHNbaV0uYXJyYXlPZlRvZG9zW2ZdLmRhdGUuc3Vic3RyKDUsIDIpID4gbW0pIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVBbGxUYXNrc0luUHJvamVjdChhcnJheU9mUHJvamVjdHNbaV0sIGYsICd1cGNvbWluZycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYoYXJyYXlPZlByb2plY3RzW2ldLmFycmF5T2ZUb2Rvc1tmXS5kYXRlLnN1YnN0cigwLCA0KSA9PSB5eXl5ICYmXG4gICAgICAgICAgICAgICBhcnJheU9mUHJvamVjdHNbaV0uYXJyYXlPZlRvZG9zW2ZdLmRhdGUuc3Vic3RyKDUsIDIpID09IG1tICYmXG4gICAgICAgICAgICAgICBhcnJheU9mUHJvamVjdHNbaV0uYXJyYXlPZlRvZG9zW2ZdLmRhdGUuc3Vic3RyKDgsIDIpID4gZGQpIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVBbGxUYXNrc0luUHJvamVjdChhcnJheU9mUHJvamVjdHNbaV0sIGYsICd1cGNvbWluZycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnVwY29taW5nJykuYXBwZW5kQ2hpbGQodXBjb21pbmdDb250YWluZXIpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVBbGxUYXNrc0luUHJvamVjdChwcm9qZWN0LCBpbmRleE9mVG9kYXlUYXNrLCBvcmlnaW4pIHtcbiAgICBpZiAoIWluZGV4T2ZUb2RheVRhc2spe1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGVudCcpLnRleHRDb250ZW50ID0gJyc7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jcmVhdGUtYnV0dG9uJykudGV4dENvbnRlbnQgPSAnJztcbiAgICAgICAgdXBkYXRlQ3VycmVudFByb2plY3QocHJvamVjdCk7XG4gICAgfSBcbiAgICBcbiAgICBmb3IobGV0IGYgPSAxOyBmIDw9IHByb2plY3QuYXJyYXlPZlRvZG9zLmxlbmd0aCAtIDE7IGYrKykge1xuICAgICAgICBsZXQgdGFza09uVGhlU2NyZWVuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHRhc2tPblRoZVNjcmVlbi5jbGFzc05hbWUgPSAndGFzayc7XG4gICAgICAgIFxuICAgICAgICBsZXQgY2hlY2tCb3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgY2hlY2tCb3gudGV4dENvbnRlbnQgPSAnJztcbiAgICAgICAgY2hlY2tCb3guY2xhc3NOYW1lID0gJ2NoZWNrYm94JztcbiAgICAgICAgdGFza09uVGhlU2NyZWVuLmFwcGVuZENoaWxkKGNoZWNrQm94KTtcblxuICAgICAgICBsZXQgdGFza05hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdGFza05hbWUudGV4dENvbnRlbnQgPSBwcm9qZWN0LmFycmF5T2ZUb2Rvc1tmXS5uYW1lO1xuICAgICAgICB0YXNrTmFtZS5jbGFzc05hbWUgPSAndGFza25hbWUnO1xuICAgICAgICB0YXNrT25UaGVTY3JlZW4uYXBwZW5kQ2hpbGQodGFza05hbWUpO1xuXG4gICAgICAgIGxldCBwcm9qZWN0RmF0aGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIHByb2plY3RGYXRoZXIudGV4dENvbnRlbnQgPSAnUHJvamVjdDogJyArIHByb2plY3QubmFtZTtcbiAgICAgICAgcHJvamVjdEZhdGhlci5jbGFzc05hbWUgPSAnZmF0aGVyLXByb2plY3QnO1xuICAgICAgICB0YXNrT25UaGVTY3JlZW4uYXBwZW5kQ2hpbGQocHJvamVjdEZhdGhlcik7XG5cbiAgICAgICAgbGV0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGRlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gcHJvamVjdC5hcnJheU9mVG9kb3NbZl0uZGVzY3JpcHRpb247XG4gICAgICAgIGRlc2NyaXB0aW9uLmNsYXNzTmFtZSA9ICdkZXNjcmlwdGlvbic7XG4gICAgICAgIHRhc2tPblRoZVNjcmVlbi5hcHBlbmRDaGlsZChkZXNjcmlwdGlvbik7XG5cbiAgICAgICAgaWYocHJvamVjdC5hcnJheU9mVG9kb3NbZl0ucHJpb3JpdHkgPT0gMSkgY2hlY2tCb3guc3R5bGUuYmFja2dyb3VuZCA9ICdyZWQnO1xuICAgICAgICBpZihwcm9qZWN0LmFycmF5T2ZUb2Rvc1tmXS5wcmlvcml0eSA9PSAyKSBjaGVja0JveC5zdHlsZS5iYWNrZ3JvdW5kID0gJ29yYW5nZSc7XG4gICAgICAgIGlmKHByb2plY3QuYXJyYXlPZlRvZG9zW2ZdLnByaW9yaXR5ID09IDMpIGNoZWNrQm94LnN0eWxlLmJhY2tncm91bmQgPSAneWVsbG93JztcbiAgICAgICAgaWYocHJvamVjdC5hcnJheU9mVG9kb3NbZl0ucHJpb3JpdHkgPT0gMCkgY2hlY2tCb3guc3R5bGUuYmFja2dyb3VuZCA9ICd3aGl0ZSc7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgY2hlY2tCb3guYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAvLyBpZiAoIWluZGV4T2ZUb2RheVRhc2spIGRlbGV0ZVRhc2socHJvamVjdCwgZik7XG4gICAgICAgICAgICBkZWxldGVUYXNrKHByb2plY3QsIGYpO1xuICAgICAgICAgICAgLy8gaWYgKGluZGV4T2ZUb2RheVRhc2spIGRlbGV0ZVRhc2socHJvamVjdCwgZiwgaW5kZXhPZlRvZGF5VGFzayk7XG4gICAgICAgICAgICBpZighaW5kZXhPZlRvZGF5VGFzayl7XG4gICAgICAgICAgICAgICAgY3JlYXRlQWxsVGFza3NJblByb2plY3QocHJvamVjdCk7XG4gICAgICAgICAgICB9ZWxzZSBpZihpbmRleE9mVG9kYXlUYXNrICYmIG9yaWdpbiA9PSAndXBjb21pbmcnKXtcbiAgICAgICAgICAgICAgICBjcmVhdGVVcGNvbWluZ1Rhc2tzKCk7XG4gICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICBjcmVhdGVUb2RheXNUYXNrcygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gKCFpbmRleE9mVG9kYXlUYXNrKSA/IGNyZWF0ZUFsbFRhc2tzSW5Qcm9qZWN0KHByb2plY3QpIDogY3JlYXRlVG9kYXlzVGFza3MoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbGV0IGRhdGVQaWNrZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdGFza09uVGhlU2NyZWVuLmFwcGVuZENoaWxkKGRhdGVQaWNrZXIpO1xuICAgICAgICBkYXRlUGlja2VyLmNsYXNzTmFtZSA9ICdkYXRlJztcbiAgICAgICAgZGF0ZVBpY2tlci50ZXh0Q29udGVudCA9IHByb2plY3QuYXJyYXlPZlRvZG9zW2ZdLmRhdGU7XG5cbiAgICAgICAgaWYoaW5kZXhPZlRvZGF5VGFzayl7XG4gICAgICAgICAgICBpZihpbmRleE9mVG9kYXlUYXNrID09IGYpIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250ZW50JykuYXBwZW5kQ2hpbGQodGFza09uVGhlU2NyZWVuKTtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGVudCcpLmFwcGVuZENoaWxkKHRhc2tPblRoZVNjcmVlbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYoIWluZGV4T2ZUb2RheVRhc2spIFRvZG9CdXR0b24ocHJvamVjdCk7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Byb2plY3RzJywgSlNPTi5zdHJpbmdpZnkoYXJyYXlPZlByb2plY3RzKSk7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZUN1cnJlbnRQcm9qZWN0KHByb2plY3QpIHtcbiAgICAocHJvamVjdC5uYW1lKSA/IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9qZWN0LW5hbWUnKS50ZXh0Q29udGVudCA9IHByb2plY3QubmFtZSA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9qZWN0LW5hbWUnKS50ZXh0Q29udGVudCA9IHByb2plY3Q7XG59XG5cbmZ1bmN0aW9uIGlucHV0UHJvamVjdE5hbWUoKSB7XG4gICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGlucHV0UHJvamVjdE5hbWUpO1xuICAgIFxuICAgIHZhciBwcm9qZWN0c0RpdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9qZWN0cycpO1xuICAgIGxldCBjbG9zZUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgIGNsb3NlQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ3Byb2plY3RzX19idG4nLCAncHJvamVjdHNfX2J0bi0tY2xvc2UnKTtcbiAgICBjbG9zZUJ1dHRvbi50ZXh0Q29udGVudCA9ICd4JztcbiAgICBjbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgcHJvamVjdHNEaXYucmVtb3ZlQ2hpbGQoaW5wdXRGb3JQcm9qZWN0TmFtZSk7XG4gICAgICAgIHByb2plY3RzRGl2LnJlbW92ZUNoaWxkKHN1Ym1pdEJ1dHRvbkZvclByb2plY3ROYW1lKTtcbiAgICAgICAgcHJvamVjdHNEaXYucmVtb3ZlQ2hpbGQoY2xvc2VCdXR0b24pO1xuICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaW5wdXRQcm9qZWN0TmFtZSk7XG4gICAgfSk7XG4gICAgXG4gICAgdmFyIGlucHV0Rm9yUHJvamVjdE5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgIGlucHV0Rm9yUHJvamVjdE5hbWUuc2V0QXR0cmlidXRlKCd0eXBlJywgJ3RleHQnKTtcbiAgICBpbnB1dEZvclByb2plY3ROYW1lLmNsYXNzTGlzdC5hZGQoJ3Byb2plY3RzX19uYW1lLWlucHV0Jyk7XG4gICAgXG4gICAgcHJvamVjdHNEaXYuYXBwZW5kQ2hpbGQoaW5wdXRGb3JQcm9qZWN0TmFtZSk7XG4gICAgXG4gICAgdmFyIHN1Ym1pdEJ1dHRvbkZvclByb2plY3ROYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgY2xvc2VCdXR0b24uY2xhc3NMaXN0LmFkZCgncHJvamVjdHNfX2J0bicsICdwcm9qZWN0c19fYnRuLS1zdWJtaXQnKTtcblxuICAgIHByb2plY3RzRGl2LmFwcGVuZENoaWxkKGNsb3NlQnV0dG9uKTtcbiAgICBwcm9qZWN0c0Rpdi5hcHBlbmRDaGlsZChzdWJtaXRCdXR0b25Gb3JQcm9qZWN0TmFtZSk7XG4gICAgc3VibWl0QnV0dG9uRm9yUHJvamVjdE5hbWUudGV4dENvbnRlbnQgPSAnT2snO1xuXG4gICAgXG4gICAgc3VibWl0QnV0dG9uRm9yUHJvamVjdE5hbWUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGxldCBuYW1lID0gaW5wdXRGb3JQcm9qZWN0TmFtZS52YWx1ZTtcbiAgICAgICAgXG4gICAgICAgIGlmKG5hbWUgJiYgbmFtZS5sZW5ndGggPCAxNiAmJiBjaGVja0lkZW50aWNhbFByb2plY3QobmFtZSkpIHtcbiAgICAgICAgICAgIHByb2plY3RzRGl2LnJlbW92ZUNoaWxkKGlucHV0Rm9yUHJvamVjdE5hbWUpO1xuICAgICAgICAgICAgcHJvamVjdHNEaXYucmVtb3ZlQ2hpbGQoc3VibWl0QnV0dG9uRm9yUHJvamVjdE5hbWUpO1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNyZWF0ZS1idXR0b24nKS50ZXh0Q29udGVudCA9ICcnO1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3QtbmFtZScpLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICAgICAgICAgIGNyZWF0ZVByb2plY3QobmFtZSk7XG4gICAgICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaW5wdXRQcm9qZWN0TmFtZSk7XG4gICAgICAgIH1lbHNlIGlmKGNoZWNrSWRlbnRpY2FsUHJvamVjdChuYW1lKSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgYWxlcnQoJ1Byb2plY3QgbmFtZXMgc2hvdWxkIGJlIGRpZmZlcmVudCcpO1xuICAgICAgICAgICAgaW5wdXRGb3JQcm9qZWN0TmFtZS52YWx1ZSA9ICcnO1xuICAgICAgICB9ZWxzZSBpZihuYW1lLmxlbmd0aCA+PSAxNil7XG4gICAgICAgICAgICBhbGVydCgnUHJvamVjdCBuYW1lIHNob3VsZCBiZSBsZXNzIHRoYW4gMTYgY2hhcmFjdGVycycpO1xuICAgICAgICB9ZWxzZSBpZighbmFtZSl7XG4gICAgICAgICAgICBhbGVydCgnRW50ZXIgcHJvamVjdCBuYW1lJyk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gY2hlY2tJZGVudGljYWxQcm9qZWN0KG5hbWUpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFycmF5T2ZQcm9qZWN0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZihhcnJheU9mUHJvamVjdHNbaV0ubmFtZSA9PSBuYW1lKSByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxuXG5mdW5jdGlvbiBkZWxldGVUYXNrKG5ld1Byb2plY3QsIG51bWJlck9mVGFzaykge1xuICAgIG5ld1Byb2plY3QuYXJyYXlPZlRvZG9zLnNwbGljZShudW1iZXJPZlRhc2ssIDEpOyBcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJvamVjdHMnLCBKU09OLnN0cmluZ2lmeShhcnJheU9mUHJvamVjdHMpKTtcbn1cblxuZnVuY3Rpb24gZGVsZXRlUHJvamVjdChuZXdQcm9qZWN0KSB7XG4gICAgZm9yKGxldCBpID0gMDsgaSA8IGFycmF5T2ZQcm9qZWN0cy5sZW5ndGg7IGkrKyl7XG4gICAgICAgIGlmKGFycmF5T2ZQcm9qZWN0c1tpXSA9PSBuZXdQcm9qZWN0KXtcbiAgICAgICAgICAgIGFycmF5T2ZQcm9qZWN0cy5zcGxpY2UoaSwgMSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3Byb2plY3RzJywgSlNPTi5zdHJpbmdpZnkoYXJyYXlPZlByb2plY3RzKSk7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRlbnQnKS50ZXh0Q29udGVudCA9ICcnO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jcmVhdGUtYnV0dG9uJykudGV4dENvbnRlbnQgPSAnJztcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdC1uYW1lJykudGV4dENvbnRlbnQgPSAnJztcbiAgICB1cGRhdGVQcm9qZWN0cygpO1xufVxuXG5leHBvcnQge2lucHV0UHJvamVjdE5hbWUsIGNyZWF0ZUFsbFRhc2tzSW5Qcm9qZWN0LCBhcnJheU9mUHJvamVjdHN9IiwiaW1wb3J0IHsgVG9kbyB9IGZyb20gXCIuL3RvZG9zXCI7XG5pbXBvcnQgeyBjcmVhdGVBbGxUYXNrc0luUHJvamVjdCwgYXJyYXlPZlByb2plY3RzIH0gZnJvbSBcIi4vdXBkYXRlUHJvamVjdHNET01cIjtcblxuZnVuY3Rpb24gVG9kb0J1dHRvbihuZXdQcm9qZWN0KSB7XG4gICAgbGV0IHRvZG9CdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgIFxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jcmVhdGUtYnV0dG9uJykuYXBwZW5kQ2hpbGQodG9kb0J1dHRvbik7XG4gICAgdG9kb0J1dHRvbi50ZXh0Q29udGVudCA9ICdDcmVhdGUgdG9kbyc7XG4gICAgdG9kb0J1dHRvbi5jbGFzc05hbWUgPSAnY3JlYXRlLWJ1dHRvbl9fYnRuJztcblxuICAgIHRvZG9CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGNyZWF0ZVBvcHVwKG5ld1Byb2plY3QpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVQb3B1cChuZXdQcm9qZWN0KSB7XG4gICAgLy8gcG9wdXAuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgbGV0IHBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwLWNvbnRhaW5lcicpO1xuICAgIHBvcHVwLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZSgxKSc7XG4gICAgXG4gICAgZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIGlmIChldmVudC50YXJnZXQgPT0gcG9wdXApIHtcbiAgICAgICAgICAgIHBvcHVwLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZSgwKSc7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc3VibWl0LWJ1dHRvblwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZ2V0RGF0YUZyb21Gb3JtLCBmYWxzZSk7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zdWJtaXQtYnV0dG9uXCIpLnBhcmFtZXRlciA9IG5ld1Byb2plY3Q7XG59XG5cbmZ1bmN0aW9uIGdldERhdGFGcm9tRm9ybShlKSB7XG4gICAgbGV0IG5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFza25hbWUnKS52YWx1ZTtcbiAgICBsZXQgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVzY3JpcHRpb24nKS52YWx1ZTtcbiAgICBsZXQgZGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkYXRlJykudmFsdWU7XG4gICAgbGV0IHByaW9yaXR5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ByaW9yaXR5JykudmFsdWU7XG5cbiAgICBpZiAobmFtZSkge1xuICAgICAgICBsZXQgdGFzayA9IFRvZG8obmFtZSwgZGVzY3JpcHRpb24sIGRhdGUsIHByaW9yaXR5KVxuICAgICAgICBlLmN1cnJlbnRUYXJnZXQucGFyYW1ldGVyLmFycmF5T2ZUb2Rvcy5wdXNoKHRhc2spO1xuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJvamVjdHMnLCBKU09OLnN0cmluZ2lmeShhcnJheU9mUHJvamVjdHMpKTtcblxuICAgICAgICBsZXQgcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXAtY29udGFpbmVyJyk7XG4gICAgICAgIHBvcHVwLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZSgwKSc7XG5cbiAgICAgICAgY3JlYXRlQWxsVGFza3NJblByb2plY3QoZS5jdXJyZW50VGFyZ2V0LnBhcmFtZXRlcik7XG4gICAgfWVsc2Uge1xuICAgICAgICBhbGVydCgnRW50ZXIgdGFzayBuYW1lJyk7XG4gICAgfVxuXG59XG5cbmV4cG9ydCB7IFRvZG9CdXR0b24gfSIsImZ1bmN0aW9uIFRvZG8obmFtZSwgZGVzY3JpcHRpb24sIGRhdGUsIHByaW9yaXR5KXtcbiAgICByZXR1cm57XG4gICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcbiAgICAgICAgZGF0ZTogZGF0ZSxcbiAgICAgICAgcHJpb3JpdHk6IHByaW9yaXR5LFxuICAgIH1cbn1cblxuZXhwb3J0IHtUb2RvfTsiLCJpbXBvcnQgeyBjcmVhdGVUb2RvIH0gZnJvbSBcIi4vdXBkYXRlVG9kb3NET01cIjtcbmltcG9ydCB7IGlucHV0UHJvamVjdE5hbWUgfSBmcm9tIFwiLi91cGRhdGVQcm9qZWN0c0RPTVwiO1xuXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdHNfX2J0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaW5wdXRQcm9qZWN0TmFtZSk7Il0sIm5hbWVzIjpbIlByb2plY3QiLCJjb25zdHJ1Y3RvciIsIm5hbWUiLCJ0aGlzIiwiYXJyYXlPZlRvZG9zIiwiYXJyYXlPZlByb2plY3RzIiwidXBkYXRlUHJvamVjdHMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJ0ZXh0Q29udGVudCIsImkiLCJsZW5ndGgiLCJwcm9qZWN0IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsImFwcGVuZENoaWxkIiwiZGVsZXRlUHJvamVjdEJ1dHRvbiIsImNsYXNzTGlzdCIsImFkZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJkZWxldGVQcm9qZWN0IiwiY3JlYXRlQWxsVGFza3NJblByb2plY3QiLCJjcmVhdGVUb2RheXNUYXNrcyIsInRvZGF5Q29udGFpbmVyIiwidG9kYXkiLCJEYXRlIiwiZGQiLCJTdHJpbmciLCJnZXREYXRlIiwicGFkU3RhcnQiLCJtbSIsImdldE1vbnRoIiwieXl5eSIsImdldEZ1bGxZZWFyIiwidXBkYXRlQ3VycmVudFByb2plY3QiLCJmIiwiZGF0ZSIsImNyZWF0ZVVwY29taW5nVGFza3MiLCJ1cGNvbWluZ0NvbnRhaW5lciIsInN1YnN0ciIsImluZGV4T2ZUb2RheVRhc2siLCJvcmlnaW4iLCJ0YXNrT25UaGVTY3JlZW4iLCJjaGVja0JveCIsInRhc2tOYW1lIiwicHJvamVjdEZhdGhlciIsImRlc2NyaXB0aW9uIiwicHJpb3JpdHkiLCJzdHlsZSIsImJhY2tncm91bmQiLCJudW1iZXJPZlRhc2siLCJzcGxpY2UiLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsImRhdGVQaWNrZXIiLCJUb2RvQnV0dG9uIiwiY2hlY2tJZGVudGljYWxQcm9qZWN0IiwibmV3UHJvamVjdCIsInRvZG9CdXR0b24iLCJwb3B1cCIsInRyYW5zZm9ybSIsImJvZHkiLCJldmVudCIsInRhcmdldCIsImdldERhdGFGcm9tRm9ybSIsInBhcmFtZXRlciIsImNyZWF0ZVBvcHVwIiwiZSIsImdldEVsZW1lbnRCeUlkIiwidmFsdWUiLCJ0YXNrIiwiVG9kbyIsImN1cnJlbnRUYXJnZXQiLCJwdXNoIiwiYWxlcnQiLCJwYXJzZSIsImdldEl0ZW0iLCJpbmJveCIsImNvbnNvbGUiLCJsb2ciLCJ0YXNrSW5zaWRlSW5ib3giLCJjcmVhdGVJbmJveCIsImlucHV0UHJvamVjdE5hbWUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwicHJvamVjdHNEaXYiLCJjbG9zZUJ1dHRvbiIsInJlbW92ZUNoaWxkIiwiaW5wdXRGb3JQcm9qZWN0TmFtZSIsInN1Ym1pdEJ1dHRvbkZvclByb2plY3ROYW1lIiwic2V0QXR0cmlidXRlIiwidGFza0luc2lkZVByb2plY3QiLCJjcmVhdGVQcm9qZWN0Il0sInNvdXJjZVJvb3QiOiIifQ==